[{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"vignette-information","dir":"Articles","previous_headings":"","what":"Vignette Information","title":"Introduction to corncob, no phyloseq","text":"version corncob-intro.Rmd vignette rely package phyloseq. see use corncob phyloseq objects, see additional analysis IBD microbiome dataset, check original corncob-intro.Rmd vignette. thank Dr. Thea Whitman kindly providing us example data set use vignette. can read data Whitman, Thea, et al. “Dynamics microbial community composition soil organic carbon mineralization soil following addition pyrogenic fresh organic matter.” ISME Journal 10.12 (2016): 2918.","code":""},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to corncob, no phyloseq","text":", introduce corncob, individual taxon regression model uses abundance tables sample data. corncob able model differential abundance differential variability, addresses challenges presented . Install corncob using: begin, load example data set load example data set three different data frames can see 5 sample variables. Let’s look first observations. Additionally, table gives us counts phyla sample. Let’s take look first 5 phyla first 5 samples. Finally, taxonomy table 7 taxonomic ranks.","code":"remotes::install_github(\"statdivlab/corncob\") library(corncob) library(magrittr) data(soil_phylo_sample) data(soil_phylo_otu) data(soil_phylo_taxa) head(soil_phylo_sample) ##      Plants DayAmdmt Amdmt ID Day ## S009      1       01     1  D   0 ## S204      1       21     1  D   2 ## S112      0       11     1  B   1 ## S247      0       22     2  F   2 ## S026      0       00     0  A   0 ## S023      1       00     0  C   0 soil_phylo_otu[1:5, 1:5] ##         S009 S204 S112 S247 S026 ## OTU.43   350   74  300   70   43 ## OTU.2   1796 4204 1752  695  945 ## OTU.187  280  709  426  100  139 ## OTU.150   33  151   18   13   28 ## OTU.91     0    0  184    0    0 soil_phylo_taxa[1:3, ] ##         Kingdom    Phylum           Class                 Order              ## OTU.43  \"Bacteria\" \"Nitrospirae\"    \"Nitrospira\"          \"Nitrospirales\"    ## OTU.2   \"Bacteria\" \"Proteobacteria\" \"Alphaproteobacteria\" \"Rhizobiales\"      ## OTU.187 \"Bacteria\" \"Acidobacteria\"  \"Acidobacteriia\"      \"Acidobacteriales\" ##         Family              Genus            Species ## OTU.43  \"Nitrospiraceae\"    \"Nitrospira\"     \"\"      ## OTU.2   \"Bradyrhizobiaceae\" \"Bradyrhizobium\" \"\"      ## OTU.187 \"Koribacteraceae\"   \"\"               \"\""},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"fitting-a-model","dir":"Articles","previous_headings":"","what":"Fitting a Model","title":"Introduction to corncob, no phyloseq","text":"First, let’s subset samples include DayAmdmt covariate equal 11 21 collapse samples phylum level. already done saved resulting sample data frame otu data frame. Note collapsing samples necessary, model can work taxonomic rank. However, later fitting model every taxa. can see agglomerating taxa phylum level, gone 7770 40 taxa. Thus collapse order increase speed purposes tutorial. Now fit model. demonstrate Proteobacteria. need make data frame includes sample data well Proteobacteria counts sequencing depths sample. now, include covariates, use ~ 1 model formula responses.","code":"data(soil_phylum_small_sample) sample_data <- soil_phylum_small_sample data(soil_phylum_small_otu) data <- soil_phylum_small_otu pro_data <- cbind(sample_data,                    W = unlist(data[\"Proteobacteria\", ]),                   M = colSums(data)) corncob <- bbdml(formula = cbind(W, M - W) ~ 1,              phi.formula = ~ 1,              data = pro_data)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"interpreting-a-model","dir":"Articles","previous_headings":"","what":"Interpreting a Model","title":"Introduction to corncob, no phyloseq","text":"First, let’s plot data model fit relative abundance scale. , simply type:  can access documentation plotting function typing ?plot.bbdml console. points represent relative abundances. bars represent 95% prediction intervals observed relative abundance sample. parameter B determines number bootstrap simulations used approximate prediction intervals. purposes tutorial, use small value B = 50 computational purposes, recommend higher setting accurate intervals, default B = 1000. Now let’s look plot, counts scale 95% prediction intervals (since counts parameter). , add option total = TRUE plotting code.  Finally, let’s color plot DayAmdmt covariate. , add option color = \"DayAmdmt\" plotting code.   Notice plot also reorders samples groups appear together easier compare. can observe plot might interest distinguish two groups covariates. average empirical relative abundance samples DayAmdmt = 21 tends lower less variable samples DayAmdmt = 11.","code":"plot(corncob, B = 50) plot(corncob, total = TRUE, B = 50) plot(corncob, total = TRUE, color = \"DayAmdmt\", B = 50) plot(corncob, color = \"DayAmdmt\", B = 50)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"adding-covariates","dir":"Articles","previous_headings":"","what":"Adding covariates","title":"Introduction to corncob, no phyloseq","text":"Let’s try modeling expected relative abundance variability counts DayAmdmt covariate. modifying formula phi.formula : Let’s also plot data total count relative abundance scales.   Visually, model covariates seems provide much better fit data, can compare two models statistically?","code":"corncob_da <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt,              phi.formula = ~ DayAmdmt,              data = pro_data) plot(corncob_da, color = \"DayAmdmt\", total = TRUE, B = 50) plot(corncob_da, color = \"DayAmdmt\", B = 50)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"model-selection","dir":"Articles","previous_headings":"","what":"Model Selection","title":"Introduction to corncob, no phyloseq","text":"Let’s use likelihood ratio test select final model taxon. want test null hypothesis likelihood model covariates equal likelihood model without covariates. test, use: obtain p-value much smaller cut-0.05. Therefore conclude statistically significant difference likelihood two models. Thus, probably want use model covariates taxon.","code":"lrtest(mod_null = corncob, mod = corncob_da) ## [1] 4.550571e-05"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"parameter-interpretation","dir":"Articles","previous_headings":"","what":"Parameter Interpretation","title":"Introduction to corncob, no phyloseq","text":"Now chosen model, let’s interpret model output. see summary model, type: output look familiar done regression analysis R past. Covariates associated expected relative abundance presented separately covariates associated variance counts preceded . model summary, can see DayAmdmt21 abundance coefficient negative statistically significant. suggests taxon differentially-abundant across DayAmdmt, samples DayAmdmt = 21 expected lower relative abundance. matches saw observed abundances. can also see DayAmdmt21 dispersion coefficient negative statistically significant. suggests taxon differentially-variable across DayAmdmt, samples DayAmdmt = 21 expected lower variability. matches saw observed abundances.","code":"summary(corncob_da) ##  ## Call: ## bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~DayAmdmt,  ##     data = pro_data) ##  ##  ## Coefficients associated with abundance: ##             Estimate Std. Error t value Pr(>|t|)     ## (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** ## DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ##  ## Coefficients associated with dispersion: ##             Estimate Std. Error t value Pr(>|t|)     ## (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** ## DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ##  ## Log-likelihood: -286.53"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"analysis-for-multiple-taxa","dir":"Articles","previous_headings":"","what":"Analysis for Multiple Taxa","title":"Introduction to corncob, no phyloseq","text":"want test taxa data see differentially-abundant differentially-variable? use differentialTest function. perform tests taxa, control false discovery rate account multiple comparisons. Next, use differentialTest command. specify covariates model using formula phi.formula , except longer include response term testing multiple taxa. also specify covariates want test removing formula_null phi.formula_null arguments. difference formulas null version formulas variables test. go several examples, starting test differential abundance across DayAmdmt coefficient. set fdr_cutoff controlled false discovery rate. , pass entire count table phyla data argument (setting taxa_are_rows TRUE), sample data frame sample_data argument. can see output function calling : can see list differentially-abundant taxa using: case, identified 14 taxa differentially-abundant across DayAmdmt (39 taxa tested). can see list differentially-variable taxa using: case, identified 5 taxa differentially-variable across DayAmdmt (40 taxa tested). can examine subset p-values tests using: can examine subset p-values controlling false discovery rate using: values now adjusted control false discovery rate 0.05. Now can use built-plotting function corncob view model coefficients used testing differential abundance across DayAmdmt via plot() function. can access documentation plotting function typing ?plot.differentialTest console.  , can see Bacteria_Armatimonadetes, effect DayAmdmt21 positive compared baseline (case, DayAmdmt11). wish instead make custom plots coefficients, can easily extract data used generate plots plot function setting data_only = TRUE: Finally, can see list taxa able fit model using: case, weren’t able fit GN04 automatically. ’s worthwhile investigate OTU individually case. may model overparameterized aren’t enough observations, may just initializations invalid taxa needs re-evaluated new initializations. Let’s first try examining data. see observed counts OTU zero samples except S102, observed single count. skeptical statistical model fit single observed count! corncob stable, notice issues, please log Github help us help !","code":"set.seed(1) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                  phi.formula = ~ DayAmdmt,                                  formula_null = ~ 1,                                  phi.formula_null = ~ DayAmdmt,                                  test = \"Wald\", boot = FALSE,                                  data = data,                                  sample_data = sample_data,                                  taxa_are_rows = TRUE,                                   fdr_cutoff = 0.05) da_analysis ## Object of class differentialTest  ##  ## $p: p-values  ## $p_fdr: FDR-adjusted p-values  ## $significant_taxa: taxa names of the statistically significant taxa  ## $significant_models: model summaries of the statistically significant taxa  ## $all_models: all model summaries  ## $restrictions_DA: covariates tested for differential abundance  ## $restrictions_DV: covariates tested for differential variability  ## $discriminant_taxa_DA: taxa for which at least one covariate associated with the abundance was perfectly discriminant  ## $discriminant_taxa_DV: taxa for which at least one covariate associated with the dispersion was perfectly discriminant  ##  ## plot( ) to see a plot of tested coefficients from significant taxa da_analysis$significant_taxa ##  [1] \"Proteobacteria\"   \"Gemmatimonadetes\" \"Bacteroidetes\"    \"Cyanobacteria\"    ##  [5] \"Firmicutes\"       \"Planctomycetes\"   \"Armatimonadetes\"  \"Spirochaetes\"     ##  [9] \"Elusimicrobia\"    \"BRC1\"             \"OP3\"              \"FBP\"              ## [13] \"Chlorobi\"         \"TM6\" set.seed(1) dv_analysis <- differentialTest(formula = ~ DayAmdmt,                                  phi.formula = ~ DayAmdmt,                                  formula_null = ~ DayAmdmt,                                  phi.formula_null = ~ 1,                                  test = \"LRT\", boot = FALSE,                                  data = data,                                  sample_data = sample_data,                                  taxa_are_rows = TRUE,                                   fdr_cutoff = 0.05) dv_analysis$significant_taxa ## [1] \"Acidobacteria\" \"Cyanobacteria\" \"Spirochaetes\"  \"Elusimicrobia\" ## [5] \"FBP\" da_analysis$p[1:5] ##    Acidobacteria   Proteobacteria Gemmatimonadetes   Actinobacteria  ##     6.509417e-01     3.642734e-05     3.270448e-13     3.703095e-01  ##         [Thermi]  ##     1.031419e-01 da_analysis$p_fdr[1:5] ##    Acidobacteria   Proteobacteria Gemmatimonadetes   Actinobacteria  ##     7.811301e-01     1.457094e-04     3.924537e-12     5.172748e-01  ##         [Thermi]  ##     2.062838e-01 plot(da_analysis) df <- plot(da_analysis, data_only = TRUE)  # we can easily remove special characters used in our formatting steps df <- df %>%   dplyr::mutate(variable = gsub(\"\\nDifferential Abundance\", \"\",                                 variable, fixed = TRUE))  head(df) ##            x        xmin        xmax             taxa   variable ## 1 -0.1679129 -0.24761731 -0.08820844   Proteobacteria DayAmdmt21 ## 2  0.3119623  0.22800588  0.39591870 Gemmatimonadetes DayAmdmt21 ## 3  0.2306765  0.09148981  0.36986312    Bacteroidetes DayAmdmt21 ## 4  1.7090454  1.33732670  2.08076404    Cyanobacteria DayAmdmt21 ## 5 -0.3087530 -0.49665466 -0.12085125       Firmicutes DayAmdmt21 ## 6  0.2013158  0.11895313  0.28367838   Planctomycetes DayAmdmt21 which(is.na(da_analysis$p)) %>% names ## [1] \"GN04\"   \"GN02\"   \"MVP-21\" data[\"GN04\", ] ##      S204 S112 S134 S207 S202 S139 S122 S212 S117 S104 S214 S109 S217 S229 S132 ## GN04    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0 ##      S209 S227 S107 S237 S224 S127 S137 S114 S124 S119 S219 S232 S129 S102 S234 ## GN04    0    0    0    0    0    0    0    0    0    0    0    0    0    1    0 ##      S222 S239 ## GN04    0    0"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro-no-phyloseq.html","id":"examples-of-answering-scientific-questions","dir":"Articles","previous_headings":"","what":"Examples of Answering Scientific Questions","title":"Introduction to corncob, no phyloseq","text":"now walk several scientific questions interest show can answered using hypothesis testing corncob. Note Day Amdmt factor covariates levels 0, 1, 2. Note rather strange tests, shown demonstration flexibility model . Normally, testing differential variability across covariate, recommend always controlling effect covariate abundance. first demonstrate examples small version soil dataset (note, slightly different subset data used corncob-intro.Rmd). Testing differential abundance across Day, without controlling anything else:  Testing differential abundance across Day, controlling effect Day dispersion:  Jointly testing differential abundance differential variability across Day:  examples answering scientific questions larger subset soil data set IBD data set can seen corncob-intro.Rmd.","code":"ex1 <- differentialTest(formula = ~ Day,                         phi.formula = ~ 1,                         formula_null = ~ 1,                         phi.formula_null = ~ 1,                         data = data,                         taxa_are_rows = TRUE,                         sample_data = sample_data,                          test = \"Wald\", boot = FALSE,                         fdr_cutoff = 0.05) plot(ex1) ex2 <- differentialTest(formula = ~ Day,                         phi.formula = ~ Day,                         formula_null = ~ 1,                         phi.formula_null = ~ Day,                         data = data,                         taxa_are_rows = TRUE,                         sample_data = sample_data,                          test = \"Wald\", boot = FALSE,                         fdr_cutoff = 0.05) plot(ex2) ex3 <- differentialTest(formula = ~ Day,                         phi.formula = ~ Day,                         formula_null = ~ 1,                         phi.formula_null = ~ 1,                         data = data,                         taxa_are_rows = TRUE,                         sample_data = sample_data,                          test = \"Wald\", boot = FALSE,                         fdr_cutoff = 0.05) plot(ex3)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"vignette-information","dir":"Articles","previous_headings":"","what":"Vignette Information","title":"Introduction to corncob","text":"thank Dr. Thea Whitman kindly providing us example data set use vignette. can read data Whitman, Thea, et al. “Dynamics microbial community composition soil organic carbon mineralization soil following addition pyrogenic fresh organic matter.” ISME Journal 10.12 (2016): 2918. also use IBD microbiome data Papa, Eliseo, et al. “Non-Invasive Mapping Gastrointestinal Microbiota Identifies Children Inflammatory Bowel Disease.” PLoS One 7(6), e39242. data made available Duvallet, Claire, et al. (2017). “MicrobiomeHD: human gut microbiome health disease” [Data set]. Zenodo. thank authors making data open source easily accessible.","code":""},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to corncob","text":", introduce corncob, individual taxon regression model uses abundance tables sample data. corncob able model differential abundance differential variability, addresses challenges presented . Note order follow along tutorial (use corncob!) need phyloseq installed. check phyloseq installed, can read following code run. See vignette corncob-intro--phyloseq.Rmd version vignette without dependence phyloseq. data TreeSummarizedExperiment object, object inherits SummarizedExperiment corncob still work. corncob assume first assay assay list SummarizedExperiment object abundance table interest, colData slot contains information samples. Install corncob using: begin, load example data set three different data frames combine together phyloseq object. unfamiliar phyloseq, can view description data using: now see OTU abundance table 7770 OTUs 119 samples. can extract using otu_table(). Let’s examine small subset data detail. can also see 5 sample variables. can extract using sample_data(). Let’s examine small subset detail. Finally, taxonomy table 7 taxonomic ranks.","code":"phy <- requireNamespace(\"phyloseq\", quietly = TRUE) == TRUE ## [1] \"phyloseq is installed: TRUE\" remotes::install_github(\"statdivlab/corncob\") library(corncob) library(phyloseq) library(magrittr) data(soil_phylo_sample) data(soil_phylo_otu) data(soil_phylo_taxa) soil_phylo <- phyloseq::phyloseq(phyloseq::sample_data(soil_phylo_sample),                                 phyloseq::otu_table(soil_phylo_otu, taxa_are_rows = TRUE),                                 phyloseq::tax_table(soil_phylo_taxa)) soil_phylo ## phyloseq-class experiment-level object ## otu_table()   OTU Table:         [ 7770 taxa and 119 samples ] ## sample_data() Sample Data:       [ 119 samples by 5 sample variables ] ## tax_table()   Taxonomy Table:    [ 7770 taxa by 7 taxonomic ranks ] otu_table(soil_phylo)[1:3, 1:3] ## OTU Table:          [3 taxa and 3 samples] ##                      taxa are rows ##         S009 S204 S112 ## OTU.43   350   74  300 ## OTU.2   1796 4204 1752 ## OTU.187  280  709  426 sample_data(soil_phylo)[1:3, ] ##      Plants DayAmdmt Amdmt ID Day ## S009      1       01     1  D   0 ## S204      1       21     1  D   2 ## S112      0       11     1  B   1 tax_table(soil_phylo)[1:3, ] ## Taxonomy Table:     [3 taxa by 7 taxonomic ranks]: ##         Kingdom    Phylum           Class                 Order              ## OTU.43  \"Bacteria\" \"Nitrospirae\"    \"Nitrospira\"          \"Nitrospirales\"    ## OTU.2   \"Bacteria\" \"Proteobacteria\" \"Alphaproteobacteria\" \"Rhizobiales\"      ## OTU.187 \"Bacteria\" \"Acidobacteria\"  \"Acidobacteriia\"      \"Acidobacteriales\" ##         Family              Genus            Species ## OTU.43  \"Nitrospiraceae\"    \"Nitrospira\"     \"\"      ## OTU.2   \"Bradyrhizobiaceae\" \"Bradyrhizobium\" \"\"      ## OTU.187 \"Koribacteraceae\"   \"\"               \"\""},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"fitting-a-model","dir":"Articles","previous_headings":"","what":"Fitting a Model","title":"Introduction to corncob","text":"Now, let’s set model. First, let’s subset samples include DayAmdmt covariate equal 11 21 collapse samples phylum level. Let’s examine data taxonomy table . Note collapsing samples necessary, model can work taxonomic rank. However, later fitting model every taxa. can see agglomerating taxa phylum level, gone 7770 40 taxa. Thus collapse order increase speed purposes tutorial. Now fit model. demonstrate Proteobacteria, OTU.1. now, include covariates, use ~ 1 model formula responses.","code":"soil <- soil_phylo %>%              phyloseq::subset_samples(DayAmdmt %in% c(11,21)) %>%             phyloseq::tax_glom(\"Phylum\") soil ## phyloseq-class experiment-level object ## otu_table()   OTU Table:         [ 39 taxa and 32 samples ] ## sample_data() Sample Data:       [ 32 samples by 5 sample variables ] ## tax_table()   Taxonomy Table:    [ 39 taxa by 7 taxonomic ranks ] tax_table(soil)[1:5, ] ## Taxonomy Table:     [5 taxa by 7 taxonomic ranks]: ##         Kingdom    Phylum             Class Order Family Genus Species ## OTU.19  \"Bacteria\" \"Acidobacteria\"    NA    NA    NA     NA    NA      ## OTU.1   \"Bacteria\" \"Proteobacteria\"   NA    NA    NA     NA    NA      ## OTU.15  \"Bacteria\" \"Gemmatimonadetes\" NA    NA    NA     NA    NA      ## OTU.3   \"Bacteria\" \"Actinobacteria\"   NA    NA    NA     NA    NA      ## OTU.133 \"Bacteria\" \"[Thermi]\"         NA    NA    NA     NA    NA corncob <- bbdml(formula = OTU.1 ~ 1,              phi.formula = ~ 1,              data = soil)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"interpreting-a-model","dir":"Articles","previous_headings":"","what":"Interpreting a Model","title":"Introduction to corncob","text":"First, let’s plot data model fit relative abundance scale. , simply type:  can access documentation plotting function typing ?plot.bbdml console. points represent relative abundances. bars represent 95% prediction intervals observed relative abundance sample. parameter B determines number bootstrap simulations used approximate prediction intervals. purposes tutorial, use small value B = 50 computational purposes, recommend higher setting accurate intervals, default B = 1000. Now let’s look plot, counts scale 95% prediction intervals (since counts parameter). , add option total = TRUE plotting code.  Finally, let’s color plot DayAmdmt covariate. , add option color = \"DayAmdmt\" plotting code.   Notice plot also reorders samples groups appear together easier compare. can observe plot might interest distinguish two groups covariates. average empirical relative abundance samples DayAmdmt = 21 tends lower less variable samples DayAmdmt = 11. wish instead make custom plots coefficients, can easily extract data used generate plots plot function setting data_only = TRUE:","code":"plot(corncob, B = 50) plot(corncob, total = TRUE, B = 50) plot(corncob, total = TRUE, color = \"DayAmdmt\", B = 50) plot(corncob, color = \"DayAmdmt\", B = 50) df <- plot(corncob, color = \"DayAmdmt\", B = 50, data_only = TRUE) head(df) ##             RA samples      ymin      ymax ## S204 0.3619402    S204 0.3141906 0.4346589 ## S112 0.3751641    S112 0.3134597 0.4295930 ## S134 0.3416663    S134 0.2808809 0.4330165 ## S207 0.3283367    S207 0.3168087 0.4314966 ## S202 0.3543272    S202 0.3020624 0.4102672 ## S139 0.3712145    S139 0.3203708 0.4624249"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"adding-covariates","dir":"Articles","previous_headings":"","what":"Adding covariates","title":"Introduction to corncob","text":"Let’s try modeling expected relative abundance variability counts DayAmdmt covariate. modifying formula phi.formula : Let’s also plot data total count relative abundance scales.   Visually, model covariates seems provide much better fit data, can compare two models statistically?","code":"corncob_da <- bbdml(formula = OTU.1 ~ DayAmdmt,              phi.formula = ~ DayAmdmt,              data = soil) plot(corncob_da, color = \"DayAmdmt\", total = TRUE, B = 50) plot(corncob_da, color = \"DayAmdmt\", B = 50)"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"model-selection","dir":"Articles","previous_headings":"","what":"Model Selection","title":"Introduction to corncob","text":"Let’s use likelihood ratio test select final model taxon. want test null hypothesis likelihood model covariates equal likelihood model without covariates. test, use: obtain p-value much smaller cut-0.05. Therefore conclude statistically significant difference likelihood two models. Thus, probably want use model covariates taxon.","code":"lrtest(mod_null = corncob, mod = corncob_da) ## [1] 4.550571e-05"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"parameter-interpretation","dir":"Articles","previous_headings":"","what":"Parameter Interpretation","title":"Introduction to corncob","text":"Now chosen model, let’s interpret model output. see summary model, type: output look familiar done regression analysis R past. Covariates associated expected relative abundance presented separately covariates associated variance counts preceded . model summary, can see DayAmdmt21 abundance coefficient negative statistically significant. suggests taxon differentially-abundant across DayAmdmt, samples DayAmdmt = 21 expected lower relative abundance. matches saw observed abundances. can also see DayAmdmt21 dispersion coefficient negative statistically significant. suggests taxon differentially-variable across DayAmdmt, samples DayAmdmt = 21 expected lower variability. matches saw observed abundances.","code":"summary(corncob_da) ##  ## Call: ## bbdml(formula = OTU.1 ~ DayAmdmt, phi.formula = ~DayAmdmt, data = soil) ##  ##  ## Coefficients associated with abundance: ##             Estimate Std. Error t value Pr(>|t|)     ## (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** ## DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ##  ## Coefficients associated with dispersion: ##             Estimate Std. Error t value Pr(>|t|)     ## (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** ## DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ##  ## Log-likelihood: -286.53"},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"analysis-for-multiple-taxa","dir":"Articles","previous_headings":"","what":"Analysis for Multiple Taxa","title":"Introduction to corncob","text":"want test taxa data see differentially-abundant differentially-variable? use differentialTest function. perform tests taxa, control false discovery rate account multiple comparisons. Next, use differentialTest command. specify covariates model using formula phi.formula , except longer include response term testing multiple taxa. also specify covariates want test removing formula_null phi.formula_null arguments. difference formulas null version formulas variables test. go several examples, starting test differential abundance across DayAmdmt coefficient. set fdr_cutoff controlled false discovery rate. can see output function calling : can see list differentially-abundant taxa using: case, identified several taxa differentially-abundant across DayAmdmt (39 taxa tested). can see list differentially-variable taxa using: can switch OTU labels taxonomic labels using otu_to_taxonomy. supply OTU labels strings OTU argument. supply phyloseq object data argument. case, identified several taxa differentially-variable across DayAmdmt (40 taxa tested). can examine subset p-values tests using: can examine subset p-values controlling false discovery rate using: values now adjusted control false discovery rate 0.05. Now can use built-plotting function corncob view model coefficients used testing differential abundance across DayAmdmt via plot() function. can access documentation plotting function typing ?plot.differentialTest console.  , can see Bacteria_Armatimonadetes, effect DayAmdmt21 positive compared baseline (case, DayAmdmt11). wish instead make custom plots coefficients, can easily extract data used generate plots plot function setting data_only = TRUE: Finally, can see list taxa able fit model using: case, weren’t able fit OTU.4206 automatically. ’s worthwhile investigate OTU individually case. First let’s check phylum represents. may model overparameterized aren’t enough observations, may just initializations invalid taxa needs re-evaluated new initializations. Let’s first try examining data. see observed counts OTU zero samples except S102, observed single count. Let’s try fitting model individually letting model select initializations automatically. model fits, skeptical statistical model fit single observed count! corncob stable, notice issues, please log Github help us help !","code":"set.seed(1) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                  phi.formula = ~ DayAmdmt,                                  formula_null = ~ 1,                                  phi.formula_null = ~ DayAmdmt,                                  test = \"Wald\", boot = FALSE,                                  data = soil,                                  fdr_cutoff = 0.05) da_analysis ## Object of class differentialTest  ##  ## $p: p-values  ## $p_fdr: FDR-adjusted p-values  ## $significant_taxa: taxa names of the statistically significant taxa  ## $significant_models: model summaries of the statistically significant taxa  ## $all_models: all model summaries  ## $restrictions_DA: covariates tested for differential abundance  ## $restrictions_DV: covariates tested for differential variability  ## $discriminant_taxa_DA: taxa for which at least one covariate associated with the abundance was perfectly discriminant  ## $discriminant_taxa_DV: taxa for which at least one covariate associated with the dispersion was perfectly discriminant  ##  ## plot( ) to see a plot of tested coefficients from significant taxa da_analysis$significant_taxa ##  [1] \"OTU.1\"    \"OTU.15\"   \"OTU.8\"    \"OTU.69\"   \"OTU.6\"    \"OTU.59\"   ##  [7] \"OTU.695\"  \"OTU.628\"  \"OTU.703\"  \"OTU.908\"  \"OTU.1570\" \"OTU.417\"  ## [13] \"OTU.584\"  \"OTU.1672\" set.seed(1) dv_analysis <- differentialTest(formula = ~ DayAmdmt,                                  phi.formula = ~ DayAmdmt,                                  formula_null = ~ DayAmdmt,                                  phi.formula_null = ~ 1,                                  data = soil,                                  test = \"LRT\", boot = FALSE,                                  fdr_cutoff = 0.05) dv_analysis$significant_taxa ## [1] \"OTU.19\"  \"OTU.69\"  \"OTU.628\" \"OTU.703\" \"OTU.417\" otu_to_taxonomy(OTU = da_analysis$significant_taxa, data = soil) ##                       OTU.1                      OTU.15  ##   \"Bacteria_Proteobacteria\" \"Bacteria_Gemmatimonadetes\"  ##                       OTU.8                      OTU.69  ##    \"Bacteria_Bacteroidetes\"    \"Bacteria_Cyanobacteria\"  ##                       OTU.6                      OTU.59  ##       \"Bacteria_Firmicutes\"   \"Bacteria_Planctomycetes\"  ##                     OTU.695                     OTU.628  ##  \"Bacteria_Armatimonadetes\"     \"Bacteria_Spirochaetes\"  ##                     OTU.703                     OTU.908  ##    \"Bacteria_Elusimicrobia\"             \"Bacteria_BRC1\"  ##                    OTU.1570                     OTU.417  ##              \"Bacteria_OP3\"              \"Bacteria_FBP\"  ##                     OTU.584                    OTU.1672  ##         \"Bacteria_Chlorobi\"              \"Bacteria_TM6\" otu_to_taxonomy(OTU = dv_analysis$significant_taxa, data = soil) ##                   OTU.19                   OTU.69                  OTU.628  ## \"Bacteria_Acidobacteria\" \"Bacteria_Cyanobacteria\"  \"Bacteria_Spirochaetes\"  ##                  OTU.703                  OTU.417  ## \"Bacteria_Elusimicrobia\"           \"Bacteria_FBP\" da_analysis$p[1:5] ##       OTU.19        OTU.1       OTU.15        OTU.3      OTU.133  ## 6.509417e-01 3.642734e-05 3.270448e-13 3.703095e-01 1.031419e-01 da_analysis$p_fdr[1:5] ##       OTU.19        OTU.1       OTU.15        OTU.3      OTU.133  ## 7.811301e-01 1.457094e-04 3.924537e-12 5.172748e-01 2.062838e-01 plot(da_analysis) df <- plot(da_analysis, data_only = TRUE)  # we can easily remove special characters used in our formatting steps df <- df %>%   dplyr::mutate(variable = gsub(\"\\nDifferential Abundance\", \"\",                                 variable, fixed = TRUE))  head(df) ##            x        xmin        xmax                      taxa   variable ## 1 -0.1679129 -0.24761731 -0.08820844   Bacteria_Proteobacteria DayAmdmt21 ## 2  0.3119623  0.22800588  0.39591870 Bacteria_Gemmatimonadetes DayAmdmt21 ## 3  0.2306765  0.09148981  0.36986312    Bacteria_Bacteroidetes DayAmdmt21 ## 4  1.7090454  1.33732670  2.08076404    Bacteria_Cyanobacteria DayAmdmt21 ## 5 -0.3087530 -0.49665466 -0.12085125       Bacteria_Firmicutes DayAmdmt21 ## 6  0.2013158  0.11895313  0.28367838   Bacteria_Planctomycetes DayAmdmt21 which(is.na(da_analysis$p)) %>% names ## [1] \"OTU.4206\" \"OTU.8773\" \"OTU.8219\" otu_to_taxonomy(OTU = \"OTU.4206\", data = soil) ##        OTU.4206  ## \"Bacteria_GN04\" otu_table(soil)[\"OTU.4206\"] ## OTU Table:          [1 taxa and 32 samples] ##                      taxa are rows ##          S204 S112 S134 S207 S202 S139 S122 S212 S117 S104 S214 S109 S217 S229 ## OTU.4206    0    0    0    0    0    0    0    0    0    0    0    0    0    0 ##          S132 S209 S227 S107 S237 S224 S127 S137 S114 S124 S119 S219 S232 S129 ## OTU.4206    0    0    0    0    0    0    0    0    0    0    0    0    0    0 ##          S102 S234 S222 S239 ## OTU.4206    1    0    0    0 check_GN04 <- bbdml(formula = OTU.4206 ~ DayAmdmt,                  phi.formula = ~ DayAmdmt,                  data = soil) ## Warning: Separation detected in abundance model! ## Likely, one of your covariates/experimental conditions is such that ## there are all zero counts within a group. The results of this model should ## be interpreted with care because there is insufficient data to distinguish between groups. ## Warning: Separation detected in dispersion model! ## Likely, one of your covariates/experimental conditions is such that ## there are all zero counts within a group. The results of this model should ## be interpreted with care because there is insufficient data to distinguish between groups."},{"path":"https://statdivlab.github.io/corncob/articles/corncob-intro.html","id":"examples-of-answering-scientific-questions","dir":"Articles","previous_headings":"","what":"Examples of Answering Scientific Questions","title":"Introduction to corncob","text":"now walk several scientific questions interest show can answered using hypothesis testing corncob. Note Day Amdmt factor covariates levels 0, 1, 2. Note rather strange tests, shown demonstration flexibility model . Normally, testing differential variability across covariate, recommend always controlling effect covariate abundance. first demonstrate examples soil dataset. Testing differential abundance across Day, without controlling anything else:  Testing differential abundance across Day, controlling effect Day dispersion:  Jointly testing differential abundance differential variability across Day:  Jointly testing differential abundance differential variability across Day, controlling effect Amdmt abundance :  Jointly testing differential abundance across Day differential abundance across Amdmt, controlling effect Day Amdmt dispersion:  Jointly testing differential abundance across Day, differential dispersion across Amdmt, controlling effect Day Dispersion:  now demonstrate examples IBD data set. begin agglomerating purposes demonstration. agglomerate genus level. Testing differential abundance across IBD status, without controlling anything else:  can make plot cleaner using level parameter. display family genus information.  Jointly testing differential abundance differential variability across IBD status, without controlling anything else:","code":"soil_full <- soil_phylo %>%    tax_glom(\"Phylum\") ex1 <- differentialTest(formula = ~ Day,                                  phi.formula = ~ 1,                                  formula_null = ~ 1,                                  phi.formula_null = ~ 1,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex1) ex2 <- differentialTest(formula = ~ Day,                                  phi.formula = ~ Day,                                  formula_null = ~ 1,                                  phi.formula_null = ~ Day,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex2) ex3 <- differentialTest(formula = ~ Day,                                  phi.formula = ~ Day,                                  formula_null = ~ 1,                                  phi.formula_null = ~ 1,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex3) ex4 <- differentialTest(formula = ~ Day + Amdmt,                                  phi.formula = ~ Day,                                  formula_null = ~ Amdmt,                                  phi.formula_null = ~ 1,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex4) ex5 <- differentialTest(formula = ~ Day + Amdmt,                                  phi.formula = ~ Day + Amdmt,                                  formula_null = ~ 1,                                  phi.formula_null = ~ Day + Amdmt,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex5) ex6 <- differentialTest(formula = ~ Day,                                  phi.formula = ~ Day + Amdmt,                                  formula_null = ~ 1,                                  phi.formula_null = ~ Day,                                  data = soil_full,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex6) data(ibd_phylo_sample) data(ibd_phylo_otu) data(ibd_phylo_taxa) ibd_phylo <-  phyloseq::phyloseq(phyloseq::sample_data(ibd_phylo_sample),                                   phyloseq::otu_table(ibd_phylo_otu, taxa_are_rows = TRUE),                                  phyloseq::tax_table(ibd_phylo_taxa)) ibd <- ibd_phylo %>%              phyloseq::tax_glom(\"Genus\") ex7 <- differentialTest(formula = ~ ibd,                                  phi.formula = ~ 1,                                  formula_null = ~ 1,                                  phi.formula_null = ~ 1,                                  data = ibd,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex7) plot(ex7, level = c(\"Family\", \"Genus\")) ex8 <- differentialTest(formula = ~ ibd,                                  phi.formula = ~ ibd,                                  formula_null = ~ 1,                                  phi.formula_null = ~ 1,                                  data = ibd,                                  test = \"Wald\", boot = FALSE,                                  fdr_cutoff = 0.05) plot(ex8, level = \"Genus\")"},{"path":"https://statdivlab.github.io/corncob/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Bryan D Martin. Author. Daniela Witten. Author. Sarah Teichman. Contributor. Amy D Willis. Author, maintainer. Thomas W Yee. Contributor.           VGAM library Xiangjie Xue. Contributor.           VGAM library","code":""},{"path":"https://statdivlab.github.io/corncob/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Martin B, Witten D, Willis (2025). corncob: Count Regression Correlated Observations Beta-Binomial. R package version 0.4.3, https://github.com/statdivlab/corncob.","code":"@Manual{,   title = {corncob: Count Regression for Correlated Observations with the Beta-Binomial},   author = {Bryan D Martin and Daniela Witten and Amy D Willis},   year = {2025},   note = {R package version 0.4.3},   url = {https://github.com/statdivlab/corncob}, }"},{"path":"https://statdivlab.github.io/corncob/index.html","id":"corncob-","dir":"","previous_headings":"","what":"Count Regression for Correlated Observations with the Beta-Binomial","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"Count Regression Correlated Observations Beta-binomial corncob R package modeling relative abundance testing hypotheses effect covariates relative abundance. corncob methodology specifically developed modelling microbial abundances based high throughput sequencing data, 16S whole-genome sequencing.","code":""},{"path":"https://statdivlab.github.io/corncob/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"install corncob package, use code download development version Github.","code":"# install.packages(\"remotes\") remotes::install_github(\"statdivlab/corncob\") library(corncob)"},{"path":"https://statdivlab.github.io/corncob/index.html","id":"docker","dir":"","previous_headings":"","what":"Docker","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"Instead installing corncob local system, can use corncob via pre-compiled Docker image: quay.io/fhcrc-microbiome/corncob.","code":""},{"path":"https://statdivlab.github.io/corncob/index.html","id":"use","dir":"","previous_headings":"","what":"Use","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"vignettes demonstrate example usage main functions (go analysis, one phyloseq objects one without phyloseq objects). Please file issue request tutorial currently included. can see vignette using following code: Note R allow variable names start numbers. Sometimes, going directly QIIME2 phyloseq objects, taxa names large string starting numbers. clean taxa names use corncob, use clean_taxa_names(my_phyloseq_object), see ?clean_taxa_names details.","code":"library(corncob) # Use this to view the vignette in the corncob HTML help help(package = \"corncob\", help_type = \"html\") # Use this to view the vignette as an isolated HTML file utils::browseVignettes(package = \"corncob\")"},{"path":"https://statdivlab.github.io/corncob/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"additionally pkgdown website contains pre-built versions function documentation, vignette, version vignette without phyloseq.","code":""},{"path":"https://statdivlab.github.io/corncob/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"use corncob analysis, please cite manuscript: Bryan D. Martin, Daniela Witten, Amy D. Willis. (2020). Modeling microbial abundances dysbiosis beta-binomial regression. Annals Applied Statistics, Volume 14, Number 1, pages 94-115. open-access preprint available arXiv .","code":""},{"path":"https://statdivlab.github.io/corncob/index.html","id":"bug-reports--change-requests","dir":"","previous_headings":"","what":"Bug Reports / Change Requests","title":"Count Regression for Correlated Observations with the Beta-Binomial","text":"encounter bug like make change request, please file issue .","code":""},{"path":"https://statdivlab.github.io/corncob/reference/HDIbetabinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Get highest density interval of beta-binomial — HDIbetabinom","title":"Get highest density interval of beta-binomial — HDIbetabinom","text":"Get highest density interval beta-binomial","code":""},{"path":"https://statdivlab.github.io/corncob/reference/HDIbetabinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get highest density interval of beta-binomial — HDIbetabinom","text":"","code":"HDIbetabinom(percent, M, mu, phi)"},{"path":"https://statdivlab.github.io/corncob/reference/HDIbetabinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get highest density interval of beta-binomial — HDIbetabinom","text":"percent Numeric. Percent interval desired. M Numeric vector sequencing depth mu Numeric vector abundance parameter phi Numeric vector dispersion parameter","code":""},{"path":"https://statdivlab.github.io/corncob/reference/HDIbetabinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get highest density interval of beta-binomial — HDIbetabinom","text":"List lower represents lower bound upper represents upper bound","code":""},{"path":"https://statdivlab.github.io/corncob/reference/HDIbetabinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get highest density interval of beta-binomial — HDIbetabinom","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) HDIbetabinom(.95, M = mod$M[1], mu = mod$mu.resp[1], phi = mod$phi.resp[1]) #> $lower #> [1] 61719 #>  #> $upper #> [1] 74743 #>"},{"path":"https://statdivlab.github.io/corncob/reference/bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","title":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","text":"Maximum Likelihood Beta-binomial Distribution","code":""},{"path":"https://statdivlab.github.io/corncob/reference/bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","text":"","code":"bbdml(   formula,   phi.formula,   data,   link = \"logit\",   phi.link = \"logit\",   method = \"trust\",   control = list(maxit = 1000, reltol = 1e-14),   numerical = FALSE,   nstart = 1,   inits = NULL,   allow_noninteger = FALSE,   robust = FALSE,   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","text":"formula object class formula: symbolic description model fitted abundance phi.formula object class formula without response: symbolic description model fitted dispersion data data frame, phyloseq, SummarizedExperiment object containing variables models link link function abundance covariates, defaults \"logit\" phi.link link function dispersion covariates, defaults \"logit\" method optimization method, defaults \"trust\", see optimr options control optimization control parameters (see optimr) numerical Boolean. Defaults FALSE. Indicator whether use numeric Hessian (recommended). nstart Integer. Defaults 1. Number starts optimization. inits Optional initializations rows matrix. Defaults NULL. allow_noninteger Boolean. Defaults FALSE. noninteger W's M's allowed? behavior permitted prior v4.1, needs explicitly allowed. robust robust standard errors returned? , model-based standard arras used. Logical, defaults FALSE. ... Optional additional arguments optimr trust","code":""},{"path":"https://statdivlab.github.io/corncob/reference/bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","text":"object class bbdml.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/bbdml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximum Likelihood for the Beta-binomial Distribution — bbdml","text":"","code":"# data frame example data(soil_phylum_small_otu1) bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) #>  #> Call: #> bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~DayAmdmt,  #>     data = soil_phylum_small_otu1) #>  #>  #> Coefficients associated with abundance: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** #> DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Coefficients associated with dispersion: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** #> DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Log-likelihood: -286.53  # phyloseq example (only run this if you have phyloseq installed) if (FALSE) { # \\dontrun{ data(soil_phylum_small_sample) data(soil_phylum_small_otu) data_phylo <- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_small_sample), phyloseq::otu_table(soil_phylum_small_otu, taxa_are_rows = TRUE)) bbdml(formula = Proteobacteria ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = data_phylo) } # }"},{"path":"https://statdivlab.github.io/corncob/reference/checkNested.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for nested models — checkNested","title":"Check for nested models — checkNested","text":"Check nested models","code":""},{"path":"https://statdivlab.github.io/corncob/reference/checkNested.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for nested models — checkNested","text":"","code":"checkNested(mod, mod_null)"},{"path":"https://statdivlab.github.io/corncob/reference/checkNested.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for nested models — checkNested","text":"mod object class bbdml mod_null object class bbdml","code":""},{"path":"https://statdivlab.github.io/corncob/reference/checkNested.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for nested models — checkNested","text":"TRUE mod_null nested within mod, otherwise throws error.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/checkNested.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check for nested models — checkNested","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1)  checkNested(mod1, mod2) #> [1] TRUE"},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename taxa — clean_taxa_names","title":"Rename taxa — clean_taxa_names","text":"Renames taxa short human-readable names","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename taxa — clean_taxa_names","text":"","code":"clean_taxa_names(x, name = \"OTU\")"},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename taxa — clean_taxa_names","text":"x Object class phyloseq name Character, defaults \"OTU\". Optional. String use every taxa name.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename taxa — clean_taxa_names","text":"Object class phyloseq, taxa renamed (defaults OTU1, OTU2, ...), original taxa names saved attribute.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rename taxa — clean_taxa_names","text":"original taxa names saved original_names attribute. See example example access original names.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename taxa — clean_taxa_names_se","title":"Rename taxa — clean_taxa_names_se","text":"Renames taxa short human-readable names","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename taxa — clean_taxa_names_se","text":"","code":"clean_taxa_names_se(x, name = \"OTU\")"},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename taxa — clean_taxa_names_se","text":"x Object class SummarizedExperiment name Character, defaults \"OTU\". Optional. String use every taxa name.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names_se.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename taxa — clean_taxa_names_se","text":"Object class SummarizedExperiment, taxa renamed (defaults OTU1, OTU2, ...), original taxa names saved attribute.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/clean_taxa_names_se.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rename taxa — clean_taxa_names_se","text":"original taxa names saved original_names attribute. See example example access original names.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"Identify differentially-abundant differentially-variable taxa using contrasts","code":""},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"","code":"contrastsTest(   formula,   phi.formula,   contrasts_DA = NULL,   contrasts_DV = NULL,   data,   link = \"logit\",   phi.link = \"logit\",   sample_data = NULL,   taxa_are_rows = TRUE,   filter_discriminant = TRUE,   fdr_cutoff = 0.05,   fdr = \"fdr\",   inits = NULL,   try_only = NULL,   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"formula object class formula without response: symbolic description model fitted abundance phi.formula object class formula without response: symbolic description model fitted dispersion contrasts_DA List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within formula. Note available \"Wald\" value test. Must include least one contrasts_DA contrasts_DV. contrasts_DV List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within phi.formula. Note available \"Wald\" value test. Must include least one contrasts_DA contrasts_DV. data data frame containing OTU table, phyloseq object containing variables models link link function abundance covariates, defaults \"logit\" phi.link link function dispersion covariates, defaults \"logit\" sample_data Data frame matrix. Defaults NULL. data data frame matrix, must included covariates/sample data. taxa_are_rows Boolean. Optional. data data frame matrix, indicates whether taxa rows. Defaults TRUE. filter_discriminant Boolean. Defaults TRUE. FALSE, discriminant taxa filtered . fdr_cutoff Integer. Defaults 0.05. Desired type 1 error rate fdr Character. Defaults \"fdr\". False discovery rate control method, see p.adjust options. inits Optional initializations model fit using formula phi.formula rows matrix. Defaults NULL. try_only Optional numeric. try try_only taxa, specified either via numeric input character taxa names. Useful speed troubleshooting. Defaults NULL, testing taxa. ... Optional additional arguments bbdml","code":""},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"object class contrastsTest. List elements p containing p-values contrast, p_fdr containing p-values false discovery rate control,  significant_taxa containing taxa names statistically significant taxa,  contrasts_DA containing contrast matrix parameters associated abundance, contrasts_DV containing contrast matrix parameters associated dispersion, discriminant_taxa_DA containing taxa least one covariate associated abundance perfectly discriminant, discriminant_taxa_DV containing taxa least one covariate associated dispersion perfectly discriminant, data containing data used fit models.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"function uses contrast matrices test differential abundance differential variability using Wald-type chi-squared test. use formula implementation, see differentialTest.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/contrastsTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify differentially-abundant and differentially-variable taxa using contrasts — contrastsTest","text":"","code":"# data frame example # note that this function will only run if the `limma` package is installed limma_install <- try(find.package(\"limma\"), silent = TRUE) if (!(inherits(limma_install, \"try-error\"))) {   data(soil_phylum_contrasts_sample)   data(soil_phylum_contrasts_otu)   da_analysis <- contrastsTest(formula = ~ DayAmdmt,                               phi.formula = ~ DayAmdmt,                               contrasts_DA = list(\"DayAmdmt21 - DayAmdmt11\",                                                    \"DayAmdmt22 - DayAmdmt21\"),                               data = soil_phylum_contrasts_otu,                                sample_data = soil_phylum_contrasts_sample,                                fdr_cutoff = 0.05,                               try_only = 1:5) } #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept #> Renaming (Intercept) to Intercept  # phyloseq example (only run if you have phyloseq installed) if (FALSE) { # \\dontrun{ contrasts_phylo <- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_contrasts_sample), phyloseq::otu_table(soil_phylum_contrasts_otu, taxa_are_rows = TRUE)) da_analysis <- contrastsTest(formula = ~ DayAmdmt,                              phi.formula = ~ DayAmdmt,                              contrasts_DA = list(\"DayAmdmt21 - DayAmdmt11\",                                                  \"DayAmdmt22 - DayAmdmt21\"),                              data = contrasts_phylo,                              fdr_cutoff = 0.05,                              try_only = 1:5) } # }"},{"path":"https://statdivlab.github.io/corncob/reference/convert_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to subset and convert phyloseq data — convert_phylo","title":"Function to subset and convert phyloseq data — convert_phylo","text":"Function subset convert phyloseq data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/convert_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to subset and convert phyloseq data — convert_phylo","text":"","code":"convert_phylo(data, select)"},{"path":"https://statdivlab.github.io/corncob/reference/convert_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to subset and convert phyloseq data — convert_phylo","text":"data phyloseq object select Name OTU taxa select, must match taxa name data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/convert_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to subset and convert phyloseq data — convert_phylo","text":"data.frame object, elements W observed counts, M sequencing depth, sample data original names.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/convert_sumexp.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to subset and convert SummarizedExperiment data — convert_sumexp","title":"Function to subset and convert SummarizedExperiment data — convert_sumexp","text":"Function subset convert SummarizedExperiment data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/convert_sumexp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to subset and convert SummarizedExperiment data — convert_sumexp","text":"","code":"convert_sumexp(data, select)"},{"path":"https://statdivlab.github.io/corncob/reference/convert_sumexp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to subset and convert SummarizedExperiment data — convert_sumexp","text":"data SummarizedExperiment object select Name OTU taxa select, must match taxa name data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/convert_sumexp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to subset and convert SummarizedExperiment data — convert_sumexp","text":"data.frame object, elements W observed counts, M sequencing depth, sample data original names.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/corncob-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Corncob package documentation. — corncob-package","title":"Corncob package documentation. — corncob-package","text":"Corncob provides methods estimating plotting count data. Specifically, corncob designed account challenges modeling sequencing data microbial abundance studies.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/corncob-package.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Corncob package documentation. — corncob-package","text":"return value. Created documentation.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/corncob-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Corncob package documentation. — corncob-package","text":"details model implemented package, see Martin et al. (2020) <doi:10.1214/19-AOAS1283>. development version package maintained https://github.com/statdivlab/corncob.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/coth.html","id":null,"dir":"Reference","previous_headings":"","what":"Hyperbolic cotangent transformation — coth","title":"Hyperbolic cotangent transformation — coth","text":"Hyperbolic cotangent transformation","code":""},{"path":"https://statdivlab.github.io/corncob/reference/coth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hyperbolic cotangent transformation — coth","text":"","code":"coth(x)"},{"path":"https://statdivlab.github.io/corncob/reference/coth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hyperbolic cotangent transformation — coth","text":"x data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/coth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hyperbolic cotangent transformation — coth","text":"Hyperbolic cotangent transformation x","code":""},{"path":"https://statdivlab.github.io/corncob/reference/coth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hyperbolic cotangent transformation — coth","text":"","code":"x <- .5 coth(x) #> [1] 2.163953"},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin.html","id":null,"dir":"Reference","previous_headings":"","what":"Betabinomial density — dbetabin","title":"Betabinomial density — dbetabin","text":"Betabinomial density","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Betabinomial density — dbetabin","text":"","code":"dbetabin(theta, W, M, X, X_star, np, npstar, link, phi.link, logpar = TRUE)"},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Betabinomial density — dbetabin","text":"theta Numeric vector. Parameters associated X X_star W Numeric vector counts M Numeric vector sequencing depth X Matrix covariates associated abundance (including intercept) X_star Matrix covariates associated dispersion (including intercept) np Number covariates associated abundance (including intercept) npstar Number covariates associated dispersion (including intercept) link ink function abundance covariates phi.link ink function dispersion covariates logpar Boolean. Defaults TRUE. Indicator whether return log-likelihood.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Betabinomial density — dbetabin","text":"Negative beta-binomial (log-)likelihood","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin_neg.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative betabinomial density — dbetabin_neg","title":"Negative betabinomial density — dbetabin_neg","text":"Created convenient helper function optimization. intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin_neg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative betabinomial density — dbetabin_neg","text":"","code":"dbetabin_neg(theta, W, M, X, X_star, np, npstar, link, phi.link, logpar = TRUE)"},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin_neg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative betabinomial density — dbetabin_neg","text":"theta Numeric vector. Parameters associated X X_star W Numeric vector counts M Numeric vector sequencing depth X Matrix covariates associated abundance (including intercept) X_star Matrix covariates associated dispersion (including intercept) np Number covariates associated abundance (including intercept) npstar Number covariates associated dispersion (including intercept) link ink function abundance covariates phi.link ink function dispersion covariates logpar Boolean. Defaults TRUE. Indicator whether return log-likelihood.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabin_neg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative betabinomial density — dbetabin_neg","text":"Negative beta-binomial (log-)likelihood","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabinom_cts.html","id":null,"dir":"Reference","previous_headings":"","what":"Densities of beta binomial distributions, permitting non integer x and size — dbetabinom_cts","title":"Densities of beta binomial distributions, permitting non integer x and size — dbetabinom_cts","text":"cases may integer W M's. cases, can still use corncob estimate parameters, need think longer coming specific beta binomial parametric model, instead estimating equations framework.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabinom_cts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Densities of beta binomial distributions, permitting non integer x and size — dbetabinom_cts","text":"","code":"dbetabinom_cts(x, size, prob, rho = 0, log = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/dbetabinom_cts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Densities of beta binomial distributions, permitting non integer x and size — dbetabinom_cts","text":"x value defined density size number trials prob probability success rho correlation parameter log TRUE, log-densities p given","code":""},{"path":"https://statdivlab.github.io/corncob/reference/dbetabinom_cts.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Densities of beta binomial distributions, permitting non integer x and size — dbetabinom_cts","text":"Thomas W Yee Xiangjie Xue Amy D Willis","code":""},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify differentially-abundant and differentially-variable taxa — differentialTest","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"Identify differentially-abundant differentially-variable taxa","code":""},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"","code":"differentialTest(   formula,   phi.formula,   formula_null,   phi.formula_null,   data,   link = \"logit\",   phi.link = \"logit\",   test,   boot = FALSE,   B = 1000,   sample_data = NULL,   taxa_are_rows = TRUE,   filter_discriminant = TRUE,   fdr_cutoff = 0.05,   fdr = \"fdr\",   full_output = FALSE,   inits = NULL,   inits_null = NULL,   try_only = NULL,   verbose = FALSE,   robust = FALSE,   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"formula object class formula without response: symbolic description model fitted abundance phi.formula object class formula without response: symbolic description model fitted dispersion formula_null Formula mean null, without response phi.formula_null Formula overdispersion null, without response data data frame containing OTU table, phyloseq, SummarizedExperiment object containing variables models link link function abundance covariates, defaults \"logit\" phi.link link function dispersion covariates, defaults \"logit\" test Character. Hypothesis testing procedure use. One \"Wald\", \"LRT\" (likelihood ratio test), \"Rao\". boot Boolean. Defaults FALSE. Indicator whether use parametric bootstrap algorithm. (See pbWald pbLRT). B Optional integer. Number bootstrap iterations. Ignored boot FALSE. Otherwise, defaults 1000. sample_data Data frame matrix. Defaults NULL. data data frame matrix, must included covariates/sample data. taxa_are_rows Boolean. Optional. data data frame matrix, indicates whether taxa rows. Defaults TRUE. filter_discriminant Boolean. Defaults TRUE. FALSE, discriminant taxa filtered . fdr_cutoff Integer. Defaults 0.05. Desired false discovery rate. fdr Character. Defaults \"fdr\". False discovery rate control method, see p.adjust options. full_output Boolean. Opetional. Defaults FALSE. Indicator whether include full bbdml model output taxa. inits Optional initializations model fit using formula phi.formula rows matrix. Defaults NULL. inits_null Optional initializations model fit using formula_null phi.formula_null rows matrix. Defaults NULL. try_only Optional numeric. try try_only taxa, specified either via numeric input character taxa names. Useful speed troubleshooting. Defaults NULL, testing taxa. verbose Boolean. Defaults FALSE; print status updates long-running analyses robust robust standard errors used? , model-based standard errors used. Logical, defaults FALSE. ... Optional additional arguments bbdml","code":""},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"object class differentialTest. List elements p containing p-values, p_fdr containing p-values false discovery rate control,  significant_taxa containing taxa names statistically significant taxa, significant_models containing list model fits significant taxa, all_models containing list model fits taxa, restrictions_DA containing list covariates tested differential abundance, restrictions_DV containing list covariates tested differential variability, discriminant_taxa_DA containing taxa least one covariate associated abundance perfectly discriminant, discriminant_taxa_DV containing taxa least one covariate associated dispersion perfectly discriminant, data containing data used fit models. full_output = TRUE, also include full_output, list model output bbdml.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"See package vignette details example usage. Make sure number columns initializations correct! inits probably match inits_null. use contrast matrix, see contrastsTest.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/differentialTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify differentially-abundant and differentially-variable taxa — differentialTest","text":"","code":"# data frame example data(soil_phylum_small_sample) data(soil_phylum_small_otu) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                 phi.formula = ~ DayAmdmt,                                 formula_null = ~ 1,                                 phi.formula_null = ~ DayAmdmt,                                 test = \"Wald\", boot = FALSE,                                 data = soil_phylum_small_otu,                                 sample_data = soil_phylum_small_sample,                                 fdr_cutoff = 0.05,                                 try_only = 1:5)  # phyloseq example (only run if you have phyloseq installed) if (FALSE) { # \\dontrun{ data_phylo <- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_small_sample), phyloseq::otu_table(soil_phylum_small_otu, taxa_are_rows = TRUE)) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                phi.formula = ~ DayAmdmt,                                formula_null = ~ 1,                                phi.formula_null = ~ DayAmdmt,                                test = \"Wald\", boot = FALSE,                                data = data_phylo,                                fdr_cutoff = 0.05,                                try_only = 1:5) } # }"},{"path":"https://statdivlab.github.io/corncob/reference/doBoot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to run a bootstrap iteration — doBoot","title":"Function to run a bootstrap iteration — doBoot","text":"Internal function. intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/doBoot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to run a bootstrap iteration — doBoot","text":"","code":"doBoot(mod, mod_null, test, robust = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/doBoot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to run a bootstrap iteration — doBoot","text":"mod object class bbdml mod_null object class bbdml test Character. Hypothesis testing procedure use. One \"Wald\" \"LRT\" (likelihood ratio test). robust robust standard errors used? , model-based standard arras used. Logical, defaults FALSE.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/doBoot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to run a bootstrap iteration — doBoot","text":"test statistic one bootstrap iteration","code":""},{"path":"https://statdivlab.github.io/corncob/reference/fishZ.html","id":null,"dir":"Reference","previous_headings":"","what":"Fisher's z transformation — fishZ","title":"Fisher's z transformation — fishZ","text":"Fisher's z transformation","code":""},{"path":"https://statdivlab.github.io/corncob/reference/fishZ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fisher's z transformation — fishZ","text":"","code":"fishZ(x)"},{"path":"https://statdivlab.github.io/corncob/reference/fishZ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fisher's z transformation — fishZ","text":"x data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/fishZ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fisher's z transformation — fishZ","text":"Fisher's z transformation x","code":""},{"path":"https://statdivlab.github.io/corncob/reference/fishZ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fisher's z transformation — fishZ","text":"","code":"x <- .5 fishZ(x) #> [1] 1.098612"},{"path":"https://statdivlab.github.io/corncob/reference/genInits.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate initialization for optimization — genInits","title":"Generate initialization for optimization — genInits","text":"Generate initialization optimization","code":""},{"path":"https://statdivlab.github.io/corncob/reference/genInits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate initialization for optimization — genInits","text":"","code":"genInits(W, M, X, X_star, np, npstar, link, phi.link, nstart = 1, use = TRUE)"},{"path":"https://statdivlab.github.io/corncob/reference/genInits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate initialization for optimization — genInits","text":"W Numeric vector counts M Numeric vector sequencing depth X Matrix covariates associated abundance (including intercept) X_star Matrix covariates associated dispersion (including intercept) np Number covariates associated abundance (including intercept) npstar Number covariates associated dispersion (including intercept) link ink function abundance covariates phi.link ink function dispersion covariates nstart Integer. Defaults 1. Number starts optimization. use Boolean. Defaults TRUE. Indicator whether use deterministic intialization.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/genInits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate initialization for optimization — genInits","text":"Matrix initializations","code":""},{"path":"https://statdivlab.github.io/corncob/reference/genInits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate initialization for optimization — genInits","text":"","code":"set.seed(1) seq_depth <- rpois(20, lambda = 10000) my_counts <- rbinom(20, size = seq_depth, prob = 0.001) * 10 my_covariate <- cbind(rep(c(0,1), each = 10)) colnames(my_covariate) <- c(\"X1\")  genInits(W = my_counts, M = seq_depth,        X = cbind(1, my_covariate), X_star = cbind(1, my_covariate),        np = 2, npstar = 2,        link = \"logit\",        phi.link = \"logit\", nstart = 2, use = TRUE) #>                        X1                     #> [1,] -4.669910 0.03427153  0.0000000 0.000000 #> [2,] -4.381932 0.28231162 -0.1073783 0.309576"},{"path":"https://statdivlab.github.io/corncob/reference/getRestrictionTerms.html","id":null,"dir":"Reference","previous_headings":"","what":"Get index of restricted terms for Wald test — getRestrictionTerms","title":"Get index of restricted terms for Wald test — getRestrictionTerms","text":"Created convenient helper function. intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/getRestrictionTerms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get index of restricted terms for Wald test — getRestrictionTerms","text":"","code":"getRestrictionTerms(   mod,   mod_null = NULL,   restrictions = NULL,   restrictions.phi = NULL )"},{"path":"https://statdivlab.github.io/corncob/reference/getRestrictionTerms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get index of restricted terms for Wald test — getRestrictionTerms","text":"mod object class bbdml mod_null Optional. object class bbdml. Defaults NULL restrictions Optional. Defaults NULL. Numeric vector indicating parameters associated abundance test, character vector name variable test. Note 1 intercept associated abundance. restrictions.phi Optional. Defaults NULL. Numeric vector indicating parameters associated dispersion test, character vector name variable test. Note 1 intercept associated dispersion.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/getRestrictionTerms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get index of restricted terms for Wald test — getRestrictionTerms","text":"list mu representing index restricted covariates associated abundance phi representing index restricted covarates associated dispersion","code":""},{"path":"https://statdivlab.github.io/corncob/reference/gr_full.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameter Gradient Vector — gr_full","title":"Parameter Gradient Vector — gr_full","text":"Used internal optimization. intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/gr_full.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameter Gradient Vector — gr_full","text":"","code":"gr_full(theta, W, M, X, X_star, np, npstar, link, phi.link, logpar = TRUE)"},{"path":"https://statdivlab.github.io/corncob/reference/gr_full.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameter Gradient Vector — gr_full","text":"theta Numeric vector. Parameters associated X X_star W Numeric vector counts M Numeric vector sequencing depth X Matrix covariates associated abundance (including intercept) X_star Matrix covariates associated dispersion (including intercept) np Number covariates associated abundance (including intercept) npstar Number covariates associated dispersion (including intercept) link ink function abundance covariates phi.link ink function dispersion covariates logpar Boolean. Defaults TRUE. Indicator whether return log-likelihood.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/gr_full.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parameter Gradient Vector — gr_full","text":"Gradient likelihood respect parameters","code":""},{"path":"https://statdivlab.github.io/corncob/reference/hessian.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Hessian matrix at the MLE — hessian","title":"Compute Hessian matrix at the MLE — hessian","text":"Compute Hessian matrix MLE","code":""},{"path":"https://statdivlab.github.io/corncob/reference/hessian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Hessian matrix at the MLE — hessian","text":"","code":"hessian(mod, numerical = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/hessian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Hessian matrix at the MLE — hessian","text":"mod object class bbdml numerical Boolean. Defaults FALSE. Indicator whether use numeric Hessian (recommended).","code":""},{"path":"https://statdivlab.github.io/corncob/reference/hessian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Hessian matrix at the MLE — hessian","text":"Hessian matrix MLE. setting, hard compute expectations calculate information matrix, return consistent estimate using sample moments: \\(\\hat{}(\\hat{\\theta}) = \\sum_i \\frac{\\partial^2}{\\partial \\theta \\partial \\theta^T} l(\\theta, W_i)\\) evaluated \\(\\theta = \\hat{\\theta}\\).","code":""},{"path":"https://statdivlab.github.io/corncob/reference/hessian.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Hessian matrix at the MLE — hessian","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) hessian(mod) #>             (Intercept)  DayAmdmt21 (Intercept) DayAmdmt21 #> (Intercept) 3587.083848 2816.656102   -4.254135  -2.521716 #> DayAmdmt21  2816.656102 2816.656102   -2.521716  -2.521716 #> (Intercept)   -4.254135   -2.521716   15.826817   7.827544 #> DayAmdmt21    -2.521716   -2.521716    7.827544   7.827544"},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_otu.html","id":null,"dir":"Reference","previous_headings":"","what":"IBD data, OTU count data frame. — ibd_phylo_otu","title":"IBD data, OTU count data frame. — ibd_phylo_otu","text":"OTU data frame phyloseq object IBD microbiome study.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_otu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IBD data, OTU count data frame. — ibd_phylo_otu","text":"","code":"ibd_phylo_otu"},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_otu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"IBD data, OTU count data frame. — ibd_phylo_otu","text":"data frame OTU counts.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_otu.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IBD data, OTU count data frame. — ibd_phylo_otu","text":"Papa, E., Docktor, M., Smillie, C., Weber, S., Preheim, S. P., Gevers, D., Giannoukos, G., Ciulla, D., Tabbaa, D., Ingram, J., Schauer, D. B., Ward, D. V., Korzenik, J. R., Xavier, R. J., Bousvaros, ., Alm, E. J. & Schauer, D. B. (2012). Non-invasive mapping gastrointestinal microbiota identifies children inflammatory bowel disease. PloS One, 7(6), e39242. <doi.org/10.1371/journal.pone.0039242>. Duvallet, C., Gibbons, S., Gurry, T., Irizarry, R., & Alm, E. (2017). MicrobiomeHD: human gut microbiome health disease [Data set]. Zenodo. <doi.org/10.5281/zenodo.1146764>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"IBD data, sample data frame. — ibd_phylo_sample","title":"IBD data, sample data frame. — ibd_phylo_sample","text":"Sample data phyloseq object IBD microbiome study.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IBD data, sample data frame. — ibd_phylo_sample","text":"","code":"ibd_phylo_sample"},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"IBD data, sample data frame. — ibd_phylo_sample","text":"data frame sample data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_sample.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IBD data, sample data frame. — ibd_phylo_sample","text":"Papa, E., Docktor, M., Smillie, C., Weber, S., Preheim, S. P., Gevers, D., Giannoukos, G., Ciulla, D., Tabbaa, D., Ingram, J., Schauer, D. B., Ward, D. V., Korzenik, J. R., Xavier, R. J., Bousvaros, ., Alm, E. J. & Schauer, D. B. (2012). Non-invasive mapping gastrointestinal microbiota identifies children inflammatory bowel disease. PloS One, 7(6), e39242. <doi.org/10.1371/journal.pone.0039242>. Duvallet, C., Gibbons, S., Gurry, T., Irizarry, R., & Alm, E. (2017). MicrobiomeHD: human gut microbiome health disease [Data set]. Zenodo. <doi.org/10.5281/zenodo.1146764>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_taxa.html","id":null,"dir":"Reference","previous_headings":"","what":"IBD data, taxonomy data frame. — ibd_phylo_taxa","title":"IBD data, taxonomy data frame. — ibd_phylo_taxa","text":"Taxonomy data phyloseq object IBD microbiome study.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_taxa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IBD data, taxonomy data frame. — ibd_phylo_taxa","text":"","code":"ibd_phylo_taxa"},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_taxa.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"IBD data, taxonomy data frame. — ibd_phylo_taxa","text":"data frame taxonomy data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/ibd_phylo_taxa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IBD data, taxonomy data frame. — ibd_phylo_taxa","text":"Papa, E., Docktor, M., Smillie, C., Weber, S., Preheim, S. P., Gevers, D., Giannoukos, G., Ciulla, D., Tabbaa, D., Ingram, J., Schauer, D. B., Ward, D. V., Korzenik, J. R., Xavier, R. J., Bousvaros, ., Alm, E. J. & Schauer, D. B. (2012). Non-invasive mapping gastrointestinal microbiota identifies children inflammatory bowel disease. PloS One, 7(6), e39242. <doi.org/10.1371/journal.pone.0039242>. Duvallet, C., Gibbons, S., Gurry, T., Irizarry, R., & Alm, E. (2017). MicrobiomeHD: human gut microbiome health disease [Data set]. Zenodo. <doi.org/10.5281/zenodo.1146764>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invfishZ.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Fisher's z transformation — invfishZ","title":"Inverse Fisher's z transformation — invfishZ","text":"Inverse Fisher's z transformation","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invfishZ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Fisher's z transformation — invfishZ","text":"","code":"invfishZ(x)"},{"path":"https://statdivlab.github.io/corncob/reference/invfishZ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Fisher's z transformation — invfishZ","text":"x data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invfishZ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse Fisher's z transformation — invfishZ","text":"Inverse Fisher's z transformation x","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invfishZ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inverse Fisher's z transformation — invfishZ","text":"","code":"x <- .5 invfishZ(x) #> [1] 0.2449187"},{"path":"https://statdivlab.github.io/corncob/reference/invlogit.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse logit transformation — invlogit","title":"Inverse logit transformation — invlogit","text":"Inverse logit transformation","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invlogit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse logit transformation — invlogit","text":"","code":"invlogit(x)"},{"path":"https://statdivlab.github.io/corncob/reference/invlogit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse logit transformation — invlogit","text":"x data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invlogit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse logit transformation — invlogit","text":"Inverse logit transformation x","code":""},{"path":"https://statdivlab.github.io/corncob/reference/invlogit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inverse logit transformation — invlogit","text":"","code":"x <- .5 invlogit(x) #> [1] 0.6224593"},{"path":"https://statdivlab.github.io/corncob/reference/logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit transformation — logit","title":"Logit transformation — logit","text":"Logit transformation","code":""},{"path":"https://statdivlab.github.io/corncob/reference/logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit transformation — logit","text":"","code":"logit(x)"},{"path":"https://statdivlab.github.io/corncob/reference/logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit transformation — logit","text":"x data","code":""},{"path":"https://statdivlab.github.io/corncob/reference/logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit transformation — logit","text":"logit x","code":""},{"path":"https://statdivlab.github.io/corncob/reference/logit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit transformation — logit","text":"","code":"x <- .5 logit(x) #> [1] 0"},{"path":"https://statdivlab.github.io/corncob/reference/lrtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood ratio test — lrtest","title":"Likelihood ratio test — lrtest","text":"Likelihood ratio test","code":""},{"path":"https://statdivlab.github.io/corncob/reference/lrtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood ratio test — lrtest","text":"","code":"lrtest(mod, mod_null)"},{"path":"https://statdivlab.github.io/corncob/reference/lrtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood ratio test — lrtest","text":"mod object class bbdml mod_null object class bbdml, nested within mod","code":""},{"path":"https://statdivlab.github.io/corncob/reference/lrtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood ratio test — lrtest","text":"P-value likelihood ratio test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/lrtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Likelihood ratio test — lrtest","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1) lrtest(mod1, mod2) #> [1] 4.550571e-05"},{"path":"https://statdivlab.github.io/corncob/reference/objfun.html","id":null,"dir":"Reference","previous_headings":"","what":"Objective function — objfun","title":"Objective function — objfun","text":"Used internal optimization. intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/objfun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Objective function — objfun","text":"","code":"objfun(theta, W, M, X, X_star, np, npstar, link, phi.link)"},{"path":"https://statdivlab.github.io/corncob/reference/objfun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Objective function — objfun","text":"theta Numeric vector. Parameters associated X X_star W Numeric vector counts M Numeric vector sequencing depth X Matrix covariates associated abundance (including intercept) X_star Matrix covariates associated dispersion (including intercept) np Number covariates associated abundance (including intercept) npstar Number covariates associated dispersion (including intercept) link ink function abundance covariates phi.link ink function dispersion covariates","code":""},{"path":"https://statdivlab.github.io/corncob/reference/objfun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Objective function — objfun","text":"List negative log-likelihood, gradient, hessian","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform OTUs to their taxonomic label — otu_to_taxonomy","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy","text":"Transform OTUs taxonomic label","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy","text":"","code":"otu_to_taxonomy(OTU, data, level = NULL)"},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy","text":"OTU String vector. Names OTU labels data data phyloseq object taxonomy table level (Optional). Character vector. Desired taxonomic levels output.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy","text":"String vector. Names taxonomic labels matching labels OTU.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform OTUs to their taxonomic label — otu_to_taxonomy_se","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy_se","text":"Transform OTUs taxonomic label","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy_se","text":"","code":"otu_to_taxonomy_se(OTU, data, level = NULL)"},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy_se","text":"OTU String vector. Names OTU labels data data phyloseq object taxonomy table level (Optional). Character vector. Desired taxonomic levels output.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/otu_to_taxonomy_se.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform OTUs to their taxonomic label — otu_to_taxonomy_se","text":"String vector. Names taxonomic labels matching labels OTU.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbLRT.html","id":null,"dir":"Reference","previous_headings":"","what":"Parametric bootstrap likelihood ratio test — pbLRT","title":"Parametric bootstrap likelihood ratio test — pbLRT","text":"Parametric bootstrap likelihood ratio test","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbLRT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parametric bootstrap likelihood ratio test — pbLRT","text":"","code":"pbLRT(mod, mod_null, B = 1000)"},{"path":"https://statdivlab.github.io/corncob/reference/pbLRT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parametric bootstrap likelihood ratio test — pbLRT","text":"mod object class bbdml mod_null object class bbdml, nested within mod B Integer. Defaults 1000. Number bootstrap iterations.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbLRT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parametric bootstrap likelihood ratio test — pbLRT","text":"P-value parametric bootstrap likelihood ratio test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbLRT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parametric bootstrap likelihood ratio test — pbLRT","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1) pbLRT(mod1, mod2, B = 50) #> [1] 0.01960784"},{"path":"https://statdivlab.github.io/corncob/reference/pbRao.html","id":null,"dir":"Reference","previous_headings":"","what":"Parametric bootstrap Rao test — pbRao","title":"Parametric bootstrap Rao test — pbRao","text":"Parametric bootstrap Rao test","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbRao.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parametric bootstrap Rao test — pbRao","text":"","code":"pbRao(mod, mod_null, B = 1000)"},{"path":"https://statdivlab.github.io/corncob/reference/pbRao.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parametric bootstrap Rao test — pbRao","text":"mod object class bbdml mod_null object class bbdml, nested within mod B Integer. Defaults 1000. Number bootstrap iterations.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbRao.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parametric bootstrap Rao test — pbRao","text":"P-value parametric bootstrap Rao test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbRao.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parametric bootstrap Rao test — pbRao","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1) pbRao(mod1, mod2, B = 10) #> [1] 1"},{"path":"https://statdivlab.github.io/corncob/reference/pbWald.html","id":null,"dir":"Reference","previous_headings":"","what":"Parametric bootstrap Wald test — pbWald","title":"Parametric bootstrap Wald test — pbWald","text":"Parametric bootstrap Wald test","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbWald.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parametric bootstrap Wald test — pbWald","text":"","code":"pbWald(mod, mod_null, B = 1000, robust = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/pbWald.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parametric bootstrap Wald test — pbWald","text":"mod object class bbdml mod_null object class bbdml, nested within mod B Integer. Defaults 1000. Number bootstrap iterations. robust robust standard errors used? , model-based standard arras used. Logical, defaults FALSE.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbWald.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parametric bootstrap Wald test — pbWald","text":"P-value parametric bootstrap Wald test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pbWald.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parametric bootstrap Wald test — pbWald","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1) pbWald(mod1, mod2, B = 50) #> [1] 0.01960784"},{"path":"https://statdivlab.github.io/corncob/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://statdivlab.github.io/corncob/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"return value. Created import pipe operator.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting function — plot.bbdml","title":"Plotting function — plot.bbdml","text":"Plotting function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting function — plot.bbdml","text":"","code":"# S3 method for class 'bbdml' plot(   x,   total = FALSE,   color = NULL,   shape = NULL,   facet = NULL,   title = NULL,   B = 1000,   sample_names = TRUE,   data_only = FALSE,   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/plot.bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting function — plot.bbdml","text":"x Object class bbdml. total (Optional). Default FALSE. Boolean indicator whether plot total counts scale color (Optional). Default NULL. sample variable map different colors. Can single character string variable name sample_data custom supplied vector length equal number samples. Use character vector ggplot2 default. shape (Optional). Default NULL. sample variable map different shapes. Can single character string variable name sample_data custom supplied vector length equal number samples. facet (Optional). Default NULL. sample variable map different panels facet grid. Must single character string variable name sample_data. title (Optional). Default NULL. Character string. main title graphic. B (Optional). Default 1000. Integer. Number bootstrap simulations prediction intervals. Use B = 0 prediction intervals. sample_names (Optional). Default TRUE. Boolean. FALSE, remove sample names plot. data_only (Optional). Default FALSE. Boolean. TRUE, returns data frame. ... optional parameters time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting function — plot.bbdml","text":"Object class ggplot. Plot bbdml model fit 95","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.bbdml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting function — plot.bbdml","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) # Here we use B = 50 for quick demonstration purposes. # In practice, we recommend a higher value for B for more accurate intervals plot(mod, color = \"DayAmdmt\", B = 50)"},{"path":"https://statdivlab.github.io/corncob/reference/plot.differentialTest.html","id":null,"dir":"Reference","previous_headings":"","what":"differentialTest plot function — plot.differentialTest","title":"differentialTest plot function — plot.differentialTest","text":"differentialTest plot function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.differentialTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"differentialTest plot function — plot.differentialTest","text":"","code":"# S3 method for class 'differentialTest' plot(x, level = NULL, data_only = FALSE, ...)"},{"path":"https://statdivlab.github.io/corncob/reference/plot.differentialTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"differentialTest plot function — plot.differentialTest","text":"x Object class differentialTest level (Optional). Character vector. Desired taxonomic levels taxa labels. data_only (Optional). Default FALSE. Boolean. TRUE, returns data frame. ... optional arguments accepted time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.differentialTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"differentialTest plot function — plot.differentialTest","text":"Object class ggplot. Plot coefficients models significant taxa differentialTest","code":""},{"path":"https://statdivlab.github.io/corncob/reference/plot.differentialTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"differentialTest plot function — plot.differentialTest","text":"","code":"# phyloseq example data(soil_phylum_small_sample) data(soil_phylum_small_otu) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                 phi.formula = ~ DayAmdmt,                                 formula_null = ~ 1,                                 phi.formula_null = ~ DayAmdmt,                                 test = \"Wald\", boot = FALSE,                                 data = soil_phylum_small_otu,                                 sample_data = soil_phylum_small_sample,                                 fdr_cutoff = 0.05,                                 try_only = 1:5) plot(da_analysis, level = \"Phylum\")"},{"path":"https://statdivlab.github.io/corncob/reference/print.bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Print function — print.bbdml","title":"Print function — print.bbdml","text":"Print function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print function — print.bbdml","text":"","code":"# S3 method for class 'bbdml' print(   x,   digits = max(3L, getOption(\"digits\") - 3L),   signif.stars = getOption(\"show.signif.stars\"),   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/print.bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print function — print.bbdml","text":"x Object class bbdml digits number significant digits use printing. signif.stars logical. TRUE, `significance stars' printed coefficient. ... optional arguments accepted time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print function — print.bbdml","text":"NULL. Displays printed model summary.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.bbdml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print function — print.bbdml","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) print(mod) #>  #> Call: #> bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~DayAmdmt,  #>     data = soil_phylum_small_otu1) #>  #>  #> Coefficients associated with abundance: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** #> DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Coefficients associated with dispersion: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** #> DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Log-likelihood: -286.53"},{"path":"https://statdivlab.github.io/corncob/reference/print.differentialTest.html","id":null,"dir":"Reference","previous_headings":"","what":"differentialTest print function — print.differentialTest","title":"differentialTest print function — print.differentialTest","text":"differentialTest print function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.differentialTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"differentialTest print function — print.differentialTest","text":"","code":"# S3 method for class 'differentialTest' print(x, ...)"},{"path":"https://statdivlab.github.io/corncob/reference/print.differentialTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"differentialTest print function — print.differentialTest","text":"x Object class bbdml ... optional arguments accepted time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.differentialTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"differentialTest print function — print.differentialTest","text":"NULL. Displays printed differentialTest summary.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.differentialTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"differentialTest print function — print.differentialTest","text":"","code":"# phyloseq example data(soil_phylum_small_sample) data(soil_phylum_small_otu) da_analysis <- differentialTest(formula = ~ DayAmdmt,                                 phi.formula = ~ DayAmdmt,                                 formula_null = ~ 1,                                 phi.formula_null = ~ DayAmdmt,                                 test = \"Wald\", boot = FALSE,                                 data = soil_phylum_small_otu,                                 sample_data = soil_phylum_small_sample,                                 fdr_cutoff = 0.05,                                 try_only = 1:5) print(da_analysis) #> Object of class differentialTest  #>  #> $p: p-values  #> $p_fdr: FDR-adjusted p-values  #> $significant_taxa: taxa names of the statistically significant taxa  #> $significant_models: model summaries of the statistically significant taxa  #> $all_models: all model summaries  #> $restrictions_DA: covariates tested for differential abundance  #> $restrictions_DV: covariates tested for differential variability  #> $discriminant_taxa_DA: taxa for which at least one covariate associated with the abundance was perfectly discriminant  #> $discriminant_taxa_DV: taxa for which at least one covariate associated with the dispersion was perfectly discriminant  #>  #> plot( ) to see a plot of tested coefficients from significant taxa"},{"path":"https://statdivlab.github.io/corncob/reference/print.summary.bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Print summary function — print.summary.bbdml","title":"Print summary function — print.summary.bbdml","text":"Print summary function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.summary.bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print summary function — print.summary.bbdml","text":"","code":"# S3 method for class 'summary.bbdml' print(   x,   digits = max(3L, getOption(\"digits\") - 3L),   signif.stars = getOption(\"show.signif.stars\"),   ... )"},{"path":"https://statdivlab.github.io/corncob/reference/print.summary.bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print summary function — print.summary.bbdml","text":"x Object class bbdml digits number significant digits use printing. signif.stars logical. TRUE, `significance stars' printed coefficient. ... optional arguments accepted time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.summary.bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print summary function — print.summary.bbdml","text":"NULL. Displays printed model summary.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/print.summary.bbdml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print summary function — print.summary.bbdml","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) print(summary(mod)) #>  #> Call: #> bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~DayAmdmt,  #>     data = soil_phylum_small_otu1) #>  #>  #> Coefficients associated with abundance: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** #> DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Coefficients associated with dispersion: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** #> DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Log-likelihood: -286.53"},{"path":"https://statdivlab.github.io/corncob/reference/qbetabinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Get quantiles of beta binom — qbetabinom","title":"Get quantiles of beta binom — qbetabinom","text":"Get quantiles beta binom","code":""},{"path":"https://statdivlab.github.io/corncob/reference/qbetabinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get quantiles of beta binom — qbetabinom","text":"","code":"qbetabinom(p, M, mu, phi)"},{"path":"https://statdivlab.github.io/corncob/reference/qbetabinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get quantiles of beta binom — qbetabinom","text":"p Numeric. Probability quantile M Numeric vector sequencing depth mu Numeric vector abundance parameter phi Numeric vector dispersion parameter","code":""},{"path":"https://statdivlab.github.io/corncob/reference/qbetabinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get quantiles of beta binom — qbetabinom","text":"quantile","code":""},{"path":"https://statdivlab.github.io/corncob/reference/qbetabinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get quantiles of beta binom — qbetabinom","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) qbetabinom(.5, M = mod$M[1], mu = mod$mu.resp[1], phi = mod$phi.resp[1]) #> [1] 68185.71"},{"path":"https://statdivlab.github.io/corncob/reference/raotest.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao-type chi-squared test (model-based or robust) — raotest","title":"Rao-type chi-squared test (model-based or robust) — raotest","text":"Rao-type chi-squared test (model-based robust)","code":""},{"path":"https://statdivlab.github.io/corncob/reference/raotest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao-type chi-squared test (model-based or robust) — raotest","text":"","code":"raotest(mod, mod_null)"},{"path":"https://statdivlab.github.io/corncob/reference/raotest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao-type chi-squared test (model-based or robust) — raotest","text":"mod object class bbdml mod_null object class bbdml, nested within mod","code":""},{"path":"https://statdivlab.github.io/corncob/reference/raotest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao-type chi-squared test (model-based or robust) — raotest","text":"P-value likelihood ratio test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/raotest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rao-type chi-squared test (model-based or robust) — raotest","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1) raotest(mod1, mod2) #> [1] 1"},{"path":"https://statdivlab.github.io/corncob/reference/sandSE.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","title":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","text":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sandSE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","text":"","code":"sandSE(mod, numerical = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/sandSE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","text":"mod object class bbdml numerical Boolean. Defaults FALSE. Indicator whether use numeric Hessian score (recommended).","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sandSE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","text":"Sandwich variance-covariance matrix","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sandSE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute sandwich standard errors. Legacy function. Use sand_vcov instead. — sandSE","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) sandSE(mod) #> Warning: You called sandSE(). Please use sand_vcov() instead. They are the same function but sand_vcov() has more transparent naming. #>              (Intercept)   DayAmdmt21  (Intercept)   DayAmdmt21 #> (Intercept)  0.001318049 -0.001318049  0.006663799 -0.006663799 #> DayAmdmt21  -0.001318049  0.001678019 -0.006663799  0.010663491 #> (Intercept)  0.006663799 -0.006663799  0.156697831 -0.156697831 #> DayAmdmt21  -0.006663799  0.010663491 -0.156697831  0.313975615"},{"path":"https://statdivlab.github.io/corncob/reference/sand_vcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","title":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","text":"Compute sandwich estimate variance-covariance matrix","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sand_vcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","text":"","code":"sand_vcov(mod, numerical = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/sand_vcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","text":"mod object class bbdml numerical Boolean. Defaults FALSE. Indicator whether use numeric Hessian score (recommended).","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sand_vcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","text":"Sandwich variance-covariance matrix. \\(\\hat{}^{-1} \\hat{B} \\hat{}^{-1}\\).","code":""},{"path":"https://statdivlab.github.io/corncob/reference/sand_vcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute sandwich estimate of variance-covariance matrix — sand_vcov","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) sand_vcov(mod) #>              (Intercept)   DayAmdmt21  (Intercept)   DayAmdmt21 #> (Intercept)  0.001318049 -0.001318049  0.006663799 -0.006663799 #> DayAmdmt21  -0.001318049  0.001678019 -0.006663799  0.010663491 #> (Intercept)  0.006663799 -0.006663799  0.156697831 -0.156697831 #> DayAmdmt21  -0.006663799  0.010663491 -0.156697831  0.313975615"},{"path":"https://statdivlab.github.io/corncob/reference/score.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute score at the MLE — score","title":"Compute score at the MLE — score","text":"Compute score MLE","code":""},{"path":"https://statdivlab.github.io/corncob/reference/score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute score at the MLE — score","text":"","code":"score(mod, numerical = FALSE, get_score_covariance = FALSE)"},{"path":"https://statdivlab.github.io/corncob/reference/score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute score at the MLE — score","text":"mod object class bbdml numerical Boolean. Defaults FALSE. Indicator whether use numeric Hessian score (recommended). get_score_covariance Boolean. Defaults FALSE. return robust estimate variance score: \\(\\hat{B}(\\hat{\\theta}) = \\sum_i G(\\hat{\\theta}; W_i) G(\\hat{\\theta}; W_i)^T\\). parameter intended users.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute score at the MLE — score","text":"Score MLE. \\(G(\\theta, w)\\) score function, returns \\(\\sum_i G(\\hat{\\theta}, W_i)\\) get_score_covariance = FALSE.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute score at the MLE — score","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) score(mod) #> [1]  6.339481e-08 -1.270095e-12  1.163048e-08 -5.889733e-12"},{"path":"https://statdivlab.github.io/corncob/reference/simulate.bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from beta-binomial model — simulate.bbdml","title":"Simulate from beta-binomial model — simulate.bbdml","text":"Simulate beta-binomial model","code":""},{"path":"https://statdivlab.github.io/corncob/reference/simulate.bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from beta-binomial model — simulate.bbdml","text":"","code":"# S3 method for class 'bbdml' simulate(object, nsim, seed = NULL, ...)"},{"path":"https://statdivlab.github.io/corncob/reference/simulate.bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from beta-binomial model — simulate.bbdml","text":"object object class bbdml nsim Integer. Number simulations seed Optional integer set random seed ... additional parameters time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/simulate.bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from beta-binomial model — simulate.bbdml","text":"nsim simulations object","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_otu.html","id":null,"dir":"Reference","previous_headings":"","what":"Soil data, otu table as data frame. — soil_phylo_otu","title":"Soil data, otu table as data frame. — soil_phylo_otu","text":"data frame made soil `phyloseq` object otu count data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_otu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soil data, otu table as data frame. — soil_phylo_otu","text":"","code":"soil_phylo_otu"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_otu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Soil data, otu table as data frame. — soil_phylo_otu","text":"phyloseq-class experiment-level object OTU table. otu_table OTU table 7,770 taxa 119 samples","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_otu.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Soil data, otu table as data frame. — soil_phylo_otu","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Soil data, sample data. — soil_phylo_sample","title":"Soil data, sample data. — soil_phylo_sample","text":"data frame made soil `phyloseq` object sample data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soil data, sample data. — soil_phylo_sample","text":"","code":"soil_phylo_sample"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Soil data, sample data. — soil_phylo_sample","text":"phyloseq-class experiment-level object sample data. sam_data sample data following covariates: Plants, values 0 1. Index different plants Day, values 0 (initial sampling point), 1 (12 days treatment additions), 2 (82 days treatment additions). Index different days measurement Amdmt, values 0 (additions), 1 (biochar additions), 2 (fresh biomass additions). Index different soil additives. DayAmdmt, values 00, 01, 02, 10, 11, 12, 20, 21, 22. single index combination Day Amdmt Day first digit Amdmt second digit. ID, values , B, C, D,  F. Index different soil plots.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_sample.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Soil data, sample data. — soil_phylo_sample","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_taxa.html","id":null,"dir":"Reference","previous_headings":"","what":"Soil data, taxa table as data frame. — soil_phylo_taxa","title":"Soil data, taxa table as data frame. — soil_phylo_taxa","text":"data frame made soil `phyloseq` object taxonomy data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_taxa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soil data, taxa table as data frame. — soil_phylo_taxa","text":"","code":"soil_phylo_taxa"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_taxa.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Soil data, taxa table as data frame. — soil_phylo_taxa","text":"phyloseq-class experiment-level object OTU table. tax_table taxonomy table","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylo_taxa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Soil data, taxa table as data frame. — soil_phylo_taxa","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_otu.html","id":null,"dir":"Reference","previous_headings":"","what":"Small soil phylum data for contrasts examples, otu table as data frame — soil_phylum_contrasts_otu","title":"Small soil phylum data for contrasts examples, otu table as data frame — soil_phylum_contrasts_otu","text":"small subset soil_phylo_otu used examples testing contrasts. data frame made `phyloseq` object otu counts.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_otu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small soil phylum data for contrasts examples, otu table as data frame — soil_phylum_contrasts_otu","text":"","code":"soil_phylum_contrasts_otu"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_otu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Small soil phylum data for contrasts examples, otu table as data frame — soil_phylum_contrasts_otu","text":"phyloseq-class experiment-level object OTU table. otu_table OTU table 39 taxa 56 samples","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_otu.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small soil phylum data for contrasts examples, otu table as data frame — soil_phylum_contrasts_otu","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Small soil phylum data for contrasts examples, sample data as data frame — soil_phylum_contrasts_sample","title":"Small soil phylum data for contrasts examples, sample data as data frame — soil_phylum_contrasts_sample","text":"small subset soil_phylo_sample used examples testing contrasts. data frame made `phyloseq` object sample data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small soil phylum data for contrasts examples, sample data as data frame — soil_phylum_contrasts_sample","text":"","code":"soil_phylum_contrasts_sample"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Small soil phylum data for contrasts examples, sample data as data frame — soil_phylum_contrasts_sample","text":"phyloseq-class experiment-level object sample data. sam_data sample data following covariates: Plants, values 0 1. Index different plants Day, values 0 (initial sampling point), 1 (12 days treatment additions), 2 (82 days treatment additions). Index different days measurement Amdmt, values 0 (additions), 1 (biochar additions), 2 (fresh biomass additions). Index different soil additives. DayAmdmt, values 00, 01, 02, 10, 11, 12, 20, 21, 22. single index combination Day Amdmt Day first digit Amdmt second digit. ID, values , B, C, D,  F. Index different soil plots.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_contrasts_sample.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small soil phylum data for contrasts examples, sample data as data frame — soil_phylum_contrasts_sample","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu.html","id":null,"dir":"Reference","previous_headings":"","what":"Small soil phylum data for examples, otu table as data frame — soil_phylum_small_otu","title":"Small soil phylum data for examples, otu table as data frame — soil_phylum_small_otu","text":"small subset soil_phylo_otu used examples. data frame made `phyloseq` object otu counts.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small soil phylum data for examples, otu table as data frame — soil_phylum_small_otu","text":"","code":"soil_phylum_small_otu"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Small soil phylum data for examples, otu table as data frame — soil_phylum_small_otu","text":"phyloseq-class experiment-level object OTU table. otu_table OTU table 39 taxa 32 samples","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small soil phylum data for examples, otu table as data frame — soil_phylum_small_otu","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu1.html","id":null,"dir":"Reference","previous_headings":"","what":"Small soil phylum data for examples, sample data as data frame combined with counts for OTU 1 and sequencing depth. — soil_phylum_small_otu1","title":"Small soil phylum data for examples, sample data as data frame combined with counts for OTU 1 and sequencing depth. — soil_phylum_small_otu1","text":"small subset soil_phylo_sample used examples. data frame made `phyloseq` object sample data counts OTU 1.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small soil phylum data for examples, sample data as data frame combined with counts for OTU 1 and sequencing depth. — soil_phylum_small_otu1","text":"","code":"soil_phylum_small_otu1"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Small soil phylum data for examples, sample data as data frame combined with counts for OTU 1 and sequencing depth. — soil_phylum_small_otu1","text":"phyloseq-class experiment-level object sample data OTU 1 counts. sam_data sample data following covariates: Plants, values 0 1. Index different plants Day, values 0 (initial sampling point), 1 (12 days treatment additions), 2 (82 days treatment additions). Index different days measurement Amdmt, values 0 (additions), 1 (biochar additions), 2 (fresh biomass additions). Index different soil additives. DayAmdmt, values 00, 01, 02, 10, 11, 12, 20, 21, 22. single index combination Day Amdmt Day first digit Amdmt second digit. ID, values , B, C, D,  F. Index different soil plots. W, counts OTU1 sample. OTU corresponds phylum Proteobacteria. M, sequencing depth sample.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_otu1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small soil phylum data for examples, sample data as data frame combined with counts for OTU 1 and sequencing depth. — soil_phylum_small_otu1","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Small soil phylum data for examples, sample data as data frame — soil_phylum_small_sample","title":"Small soil phylum data for examples, sample data as data frame — soil_phylum_small_sample","text":"small subset soil_phylo_sample used examples. data frame made `phyloseq` object sample data.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Small soil phylum data for examples, sample data as data frame — soil_phylum_small_sample","text":"","code":"soil_phylum_small_sample"},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Small soil phylum data for examples, sample data as data frame — soil_phylum_small_sample","text":"phyloseq-class experiment-level object sample data. sam_data sample data following covariates: Plants, values 0 1. Index different plants Day, values 0 (initial sampling point), 1 (12 days treatment additions), 2 (82 days treatment additions). Index different days measurement Amdmt, values 0 (additions), 1 (biochar additions), 2 (fresh biomass additions). Index different soil additives. DayAmdmt, values 00, 01, 02, 10, 11, 12, 20, 21, 22. single index combination Day Amdmt Day first digit Amdmt second digit. ID, values , B, C, D,  F. Index different soil plots.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/soil_phylum_small_sample.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Small soil phylum data for examples, sample data as data frame — soil_phylum_small_sample","text":"Whitman, T., Pepe-Ranney, C., Enders, ., Koechli, C., Campbell, .,  Buckley, D. H., Lehmann, J. (2016). Dynamics microbial community composi-tion soil organic carbon mineralization soil following addition pyrogenic andfresh organic matter. ISME journal, 10(12):2918. <doi: 10.1038/ismej.2016.68>.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/summary.bbdml.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function — summary.bbdml","title":"Summary function — summary.bbdml","text":"Summary function","code":""},{"path":"https://statdivlab.github.io/corncob/reference/summary.bbdml.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function — summary.bbdml","text":"","code":"# S3 method for class 'bbdml' summary(object, ...)"},{"path":"https://statdivlab.github.io/corncob/reference/summary.bbdml.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function — summary.bbdml","text":"object Object class bbdml ... optional arguments accepted time.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/summary.bbdml.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary function — summary.bbdml","text":"Object class summary.bbdml. Displays printed model summary.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/summary.bbdml.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary function — summary.bbdml","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) summary(mod) #>  #> Call: #> bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~DayAmdmt,  #>     data = soil_phylum_small_otu1) #>  #>  #> Coefficients associated with abundance: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept) -0.44595    0.03604 -12.375 7.18e-13 *** #> DayAmdmt21  -0.16791    0.04067  -4.129 0.000297 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Coefficients associated with dispersion: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  -5.3077     0.3537 -15.008 6.44e-15 *** #> DayAmdmt21   -1.3518     0.5029  -2.688    0.012 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #>  #> Log-likelihood: -286.53"},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald-type chi-squared test — waldchisq","title":"Wald-type chi-squared test — waldchisq","text":"Wald-type chi-squared test","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald-type chi-squared test — waldchisq","text":"","code":"waldchisq(   mod,   mod_null = NULL,   restrictions = NULL,   restrictions.phi = NULL,   contrasts_DA = NULL,   contrasts_DV = NULL,   robust = FALSE )"},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald-type chi-squared test — waldchisq","text":"mod object class bbdml mod_null Optional. object class bbdml, nested within mod. included, need include restrictions restrictions.phi. restrictions Optional. Defaults NULL. Numeric vector indicating parameters associated abundance test, character vector name variable test. Note 1 intercept associated abundance. restrictions.phi Optional. Defaults NULL. Numeric vector indicating parameters associated dispersion test, character vector name variable test. Note 1 intercept associated dispersion. contrasts_DA List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within formula. Note available \"Wald\" value test. contrasts_DV List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within phi.formula. Note available \"Wald\" value test. robust robust standard errors used? , model-based standard arras used. Logical, defaults FALSE.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wald-type chi-squared test — waldchisq","text":"Matrix wald test statistics p-values. performs univariate tests. P-value Wald test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wald-type chi-squared test — waldchisq","text":"","code":"data(soil_phylum_small_otu1) mod1 <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1)  mod2 <- bbdml(formula = cbind(W, M - W) ~ 1, phi.formula = ~ 1, data = soil_phylum_small_otu1)  # Example using mod_null waldchisq(mod = mod1, mod_null = mod2) #> [1] 6.60754e-06 #> attr(,\"df\") #> [1] 2 waldchisq(mod = mod1, mod_null = mod2, robust = TRUE) #> [1] 0.0001905122 #> attr(,\"df\") #> [1] 2  # Example using restrictions and restrictions.phi waldchisq(mod = mod1, restrictions = 2, restrictions.phi = 2) #> [1] 6.60754e-06 #> attr(,\"df\") #> [1] 2 waldchisq(mod = mod1, restrictions = \"DayAmdmt\", restrictions.phi = \"DayAmdmt\") #> [1] 6.60754e-06 #> attr(,\"df\") #> [1] 2 waldchisq(mod = mod1, restrictions = 2, restrictions.phi = \"DayAmdmt\") #> [1] 6.60754e-06 #> attr(,\"df\") #> [1] 2 waldchisq(mod = mod1, restrictions = 2, restrictions.phi = 2, robust = TRUE) #> [1] 0.0001905122 #> attr(,\"df\") #> [1] 2"},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald-type chi-squared test statistic (model-based or robust) — waldchisq_test","title":"Wald-type chi-squared test statistic (model-based or robust) — waldchisq_test","text":"helper function intended users","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald-type chi-squared test statistic (model-based or robust) — waldchisq_test","text":"","code":"waldchisq_test(   mod,   restrictions = NULL,   restrictions.phi = NULL,   contrasts_DA = NULL,   contrasts_DV = NULL,   robust = FALSE )"},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald-type chi-squared test statistic (model-based or robust) — waldchisq_test","text":"mod object class bbdml restrictions Optional. Defaults NULL. Numeric vector indicating parameters associated abundance test, character vector name variable test. Note 1 intercept associated abundance. restrictions.phi Optional. Defaults NULL. Numeric vector indicating parameters associated dispersion test, character vector name variable test. Note 1 intercept associated dispersion. contrasts_DA List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within formula. Note available \"Wald\" value test. contrasts_DV List. Optional. Constructs contrast matrix. List elements characters specifying contrasts parameters within phi.formula. Note available \"Wald\" value test. robust robust standard errors used? , model-based standard arras used. Logical, defaults FALSE.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldchisq_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wald-type chi-squared test statistic (model-based or robust) — waldchisq_test","text":"Test statistic Wald test.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldt.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald-type t test (model-based or robust) — waldt","title":"Wald-type t test (model-based or robust) — waldt","text":"Wald-type t test (model-based robust)","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald-type t test (model-based or robust) — waldt","text":"","code":"waldt(mod)"},{"path":"https://statdivlab.github.io/corncob/reference/waldt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald-type t test (model-based or robust) — waldt","text":"mod object class bbdml","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wald-type t test (model-based or robust) — waldt","text":"Matrix wald test statistics p-values. performs univariate tests.","code":""},{"path":"https://statdivlab.github.io/corncob/reference/waldt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wald-type t test (model-based or robust) — waldt","text":"","code":"data(soil_phylum_small_otu1) mod <- bbdml(formula = cbind(W, M - W) ~ DayAmdmt, phi.formula = ~ DayAmdmt, data = soil_phylum_small_otu1) waldt(mod) #>                   Estimate Std. Error    t value     Pr(>|t|) #> mu.(Intercept)  -0.4459452 0.03603627 -12.374899 7.184737e-13 #> mu.DayAmdmt21   -0.1679129 0.04066628  -4.129045 2.970223e-04 #> phi.(Intercept) -5.3077030 0.35365558 -15.008113 6.439048e-15 #> phi.DayAmdmt21  -1.3517509 0.50285497  -2.688153 1.195984e-02"},{"path":"https://statdivlab.github.io/corncob/reference/warn_phyloseq.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to throw error if the `phyloseq` package is called but it is not installed — warn_phyloseq","title":"Function to throw error if the `phyloseq` package is called but it is not installed — warn_phyloseq","text":"Function throw error `phyloseq` package called installed","code":""},{"path":"https://statdivlab.github.io/corncob/reference/warn_phyloseq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to throw error if the `phyloseq` package is called but it is not installed — warn_phyloseq","text":"","code":"warn_phyloseq()"},{"path":"https://statdivlab.github.io/corncob/reference/warn_sumexp.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to throw error if the `SummarizedExperiment` package is called but it is not installed — warn_sumexp","title":"Function to throw error if the `SummarizedExperiment` package is called but it is not installed — warn_sumexp","text":"Function throw error `SummarizedExperiment` package called installed","code":""},{"path":"https://statdivlab.github.io/corncob/reference/warn_sumexp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to throw error if the `SummarizedExperiment` package is called but it is not installed — warn_sumexp","text":"","code":"warn_sumexp()"}]
